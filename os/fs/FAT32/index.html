<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="KbCOz5IFs80bU-psVUCv9C7SOLzVWto8d7_5ZSsX7I0"><meta name="baidu-site-verification" content="codeva-KcLqIZYGXd"><link rel="alternate" type="application/rss+xml" title="藏器于身" href="https://gality.cn/rss.xml"><link rel="alternate" type="application/atom+xml" title="藏器于身" href="https://gality.cn/atom.xml"><link rel="alternate" type="application/json" title="藏器于身" href="https://gality.cn/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/css/app.css?v=0.2.5"><meta name="keywords" content="操作系统,文件系统,FAT"><link rel="canonical" href="https://gality.cn/os/fs/FAT32/"><title>文件系统详解 ｜ FAT32 - 文件系统 - 操作系统 | Samadhi = 藏器于身 = 待时而动</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">文件系统详解 ｜ FAT32</h1><div class="meta"><span class="item" title="创建时间：2024-12-19 16:51:11"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2024-12-19T16:51:11+08:00">2024-12-19</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>14k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>25 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Samadhi</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="http://imgcdn.gality.cn/blog/wx3l5k.png"></li><li class="item" data-background-image="http://imgcdn.gality.cn/blog/sc831a.jpg"></li><li class="item" data-background-image="http://imgcdn.gality.cn/blog/u2vn85.jpg"></li><li class="item" data-background-image="http://imgcdn.gality.cn/blog/2h6jtq.jpg"></li><li class="item" data-background-image="http://imgcdn.gality.cn/blog/9pu8bw.jpg"></li><li class="item" data-background-image="http://imgcdn.gality.cn/blog/kapsd3.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/os/" itemprop="item" rel="index" title="分类于 操作系统"><span itemprop="name">操作系统</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/os/fs/" itemprop="item" rel="index" title="分类于 文件系统"><span itemprop="name">文件系统</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://gality.cn/os/fs/FAT32/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/images/avatar.png"><meta itemprop="name" content="Gality"><meta itemprop="description" content="待时而动, 安全杂记 & 日常随感"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="藏器于身"></span><div class="body md" itemprop="articleBody"><div class="note info no-icon"><p>FAT 文件系统起源于 1980 年左右，是 MS-DOS 首次支持的文件系统。它最初是一个简单的文件系统，适用于容量小于 500k 字节的软盘。随着时间的推移，它的规格不断扩大，支持的介质也越来越多，容量也越来越大。FAT 是 File Allocation Table（文件分配表）的缩写，是管理数据区分配的阵列，也是文件系统本身的名称。目前有三种 FAT 子类型： <code>FAT12</code> 、 <code>FAT16</code> 和 <code>FAT32</code> 。这些子类型按编号顺序开发，完全向后兼容旧版本。( <code>FAT16</code> 总是包括 <code>FAT12</code> ， <code>FAT32</code> 包括所有 FAT 类型）。由于 <code>FAT12</code> 和 <code>FAT16</code> 最大卷大小只能支持到 <code>256MB</code> 和 <code>4GB</code> ，所以现代更多使用的是 <code>FAT32</code> 文件系统（最大卷大小 <code>2T</code> ），所以本文着重介绍 <code>FAT32</code> 的结构。</p><p>⚠️ 笔者水平有限，如有错误跪请留言指正 Orz</p></div><h1 id="文件系统基本概念"><a class="anchor" href="#文件系统基本概念">#</a> 文件系统基本概念</h1><ul><li><p><ins>扇区（Sector）</ins>：扇区是存储设备上用于读写的<strong>最小数据块单位</strong>。传统上一个硬盘扇区的大小是<strong> 512</strong> 字节。但在高级格式化硬盘中，物理扇区大小是 4096 字节，不过依然向下支持 512 字节。存储设备上的每个扇区都由一个扇区号寻址，该扇区号从存储设备顶部依次排列。</p></li><li><p><ins>块（Block）/ 簇（Cluster）</ins>：块（簇）是 操作系统与磁盘（硬盘）交互的最小数据单元（在 Linux 中称为块，在 windows 中称为簇）， 块的大小在硬盘格式化时被指定，一般有 1K，2K，4K（最常用）。如果块的大小设置为 4K，那么磁盘要读取 8 个扇区之后，才将数据块传给操作系统。另外，块也是 DOS 下数据存储的最小单元。例如，如果一个文件的大小为 1K，而块的大小为 4K，那么该文件还是会占用一个块，块中剩下的 3K 被空闲出来，不能用于存储其他数据。</p><details class="primary"><summary>扇区 vs. 簇</summary><div><p>扇区是对硬盘而言的，在物理层；块和簇是对文件系统而言的，是逻辑层。</p><p>簇和块是操作系统操作的最小单位，扇区是磁头从磁盘中读取数据的最小单位。</p><p>一般来说操作系统会将物理磁盘中的多个连续扇区合并成簇来管理，每个簇一般包括 2 的整数幂（2、4、8 等）个扇区。</p></div></details></li><li><p><ins>分区（partition）</ins>：故名思意就是将一块儿磁盘上的一些连续扇区划分成独立的逻辑区域，一般情况下可以将一个磁盘分为多个分区。每个分区可以格式化为一个 “卷”。分区被限制在一块磁盘中，不能跨磁盘建立分区。分区的记录存储在磁盘的第一个扇区中，它是一种较低层次的概念。</p></li><li><p><ins>卷（volume）</ins>：一种更高级、更抽象的分区，可以包含多个分区或多个物理硬盘，可以跨硬盘使用，是操作系统眼中的 “硬盘的样子”，每个卷有自己的文件系统并支持许多高级功能（如快照、压缩等）。这样我们可以认为，“卷” 是 “分区” 的扩展，“分区” 是 “卷” 的一种特殊情况。</p></li></ul><h1 id="fat32-详解"><a class="anchor" href="#fat32-详解">#</a> FAT32 详解</h1><p>FAT 文件系统用 “簇” 作为数据单元。一个 “簇” 由一组连续的扇区组成，簇所含的扇区数必须是 2 的整数次幂。簇的最大值为 64 个扇区，即 32KB。在 FAT 文件系统中，同时使用 “扇区地址” 和 “簇地址” 两种地址管理方式。这是因为只有存储用户数据的数据区使用簇进行管理，其他文件系统管理数据区域是不以簇进行管理的，这部分区域使用扇区地址进行管理。文件系统的起始扇区为 0 号扇区（逻辑 0 号扇区，因为卷可以不在物理磁盘的第一个分区）。</p><div class="note info"><p>请仔细区分 <code>FAT卷</code> 和 <code>FAT表</code> 的不同， <code>FAT卷</code> 指的是<ins class="wavy"> FAT 文件系统</ins>，而 <code>FAT表</code> 指的是<ins class="wavy"> FAT 文件系统中 FAT 区域</ins>。</p></div><h2 id="fat32-整体布局"><a class="anchor" href="#fat32-整体布局">#</a> FAT32 整体布局</h2><p>FAT32 文件系统由保留扇区，FAT1，FAT2 和 DATA 四个部分组成，其结构如下图：</p><p><img data-src="http://imgcdn.gality.cn/blog/c1410.png" alt="FAT32 filesystem structure"></p><p>这些结构是在分区被格式化时创建出来的，含义解释如下：</p><ul><li><p>保留区域：包括引导扇区和保留扇区，是文件系统的隐藏区域，记录着文件系统相关的信息。</p></li><li><p>FAT1：FAT 的含义是文件分配表，FAT32 一般有两份 FAT，FAT1 是第一份，也是主 FAT。</p></li><li><p>FAT2：FAT2 是 FAT32 的第二份文件分配表，也是 FAT1 的备份。</p></li><li><p>DATA：数据区，是 FAT32 文件系统的主要区域，其中包含目录区域。</p></li></ul><h2 id="fat32-保留区"><a class="anchor" href="#fat32-保留区">#</a> FAT32 保留区</h2><p>保留区包括 “引导扇区”（主引导扇区），” 备份引导扇区 “和 “保留扇区”。</p><h3 id="引导扇区boot-sector"><a class="anchor" href="#引导扇区boot-sector">#</a> 引导扇区（Boot Sector）</h3><p>在 FAT 文件系统中，文件系统的数据记录在 “引导扇区” 中。引导扇区从整个文件系统的 0 号扇区开始，长度为 3 个扇区，也称其为 DBR（DOS Boot Recorder——DOS 引导记录）扇区，DBR 中记录着文件系统的起始位置、大小、FAT 表个数及大小等相关信息，这些对于 FAT 至关重要的配置参数所在区域也被称为 BPB（BIOS Parameter Block），由于历史原因，BPB 的定义一直在变化。下表列出了引导扇区的数据字段，任何以 <code>BPB_</code> 命名的字段都是 BPB 的一部分。任何以 <code>BS_</code> 为标题的字段都不是 BPB 的一部分，而只是引导扇区的一部分：</p><table><thead><tr><th>字段名</th><th>偏移</th><th>大小</th><th>描述</th></tr></thead><tbody><tr><td><code>BS_JmpBoot</code></td><td>0</td><td>3</td><td>跳转到操作系统启动过程使用的引导代码（x86 指令）的指令。该字段有两种格式，首选前一种格式。<br>- <code>0xEB, 0x??, 0x90 (Short jump + NOP)</code><br>- <code>0xE9, 0x??, 0x?? (Near jump)</code><br><code>??</code> 是任意值，取决于跳转的位置。如果使用这些格式以外的任何格式，Windows 将无法识别卷。</td></tr><tr><td><code>BS_OEMName</code></td><td>3</td><td>8</td><td>推荐使用 <code>MSWIN 4.1</code> ，而 <code>MSDOS 5.0</code> 也经常被使用。关于该字段存在许多误解。这仅仅是一个名字，微软的操作系统并不会关注这个字段，但一些 FAT 驱动程序会参考它。推荐使用上述字符串是因为它被认为可以最大程度地减少兼容性问题。你也可以设置其他值，但某些 FAT 驱动程序可能无法识别该卷。此字段通常表示创建该卷的系统名称。</td></tr><tr><td><code>BPB_BytsPerSec</code></td><td>11</td><td>2</td><td>字节为单位的扇区大小。此字段的有效值为 <code>512</code> 、 <code>1024</code> 、 <code>2048</code> 或 <code>4096</code> 。微软操作系统能够正确支持这些扇区大小。一些 FAT 驱动程序假设扇区大小为 <code>512</code> ，并且不会检查此字段。因此，为了最大兼容性，应使用 <code>512</code> 。不过，不要误解为此字段仅与兼容性有关。此值必须与包含 FAT 卷的存储设备的扇区大小一致。</td></tr><tr><td><code>BPB_SecPerClus</code></td><td>13</td><td>1</td><td>每个分配单元的扇区数。在 FAT 文件系统中，分配单元被称为簇 (Cluster)。簇是由一个或多个连续扇区组成的数据块，数据区以此单元进行管理。每个簇的扇区数必须是 2 的幂，因此有效值为 1、2、4、... 以及 128。不过，簇大小 ( <code>BPB_BytsPerSec</code> * <code>BPB_SecPerClus</code> ) 超过 <code>32 KB</code> 的值不应使用。尽管现代系统（如 Windows）支持超过 <code>32 KB</code> 的簇大小（如 <code>64 KB</code> 、 <code>128 KB</code> 和 <code>256</code> KB），但 MS-DOS 或旧版磁盘工具无法正确识别此类卷。</td></tr><tr><td><code>BPB_ResvdSecCnt</code></td><td>14</td><td>2</td><td>保留区中的扇区数。此字段不能为 <code>0</code> ，因为包含此 BPB 的引导扇区本身就在保留区域中。为避免兼容性问题，在 <code>FAT12/16</code> 卷上此字段应为 <code>1</code> ，这是因为一些旧版 FAT 驱动程序忽略此字段，并假设保留区域的大小为 <code>1</code> 。在 <code>FAT32</code> 卷上，通常设置为 <code>32</code> 。微软的操作系统能正确支持值为 1 或更大的任何值。</td></tr><tr><td><code>BPB_NumFATs</code></td><td>16</td><td>1</td><td>FAT 表的数量。此字段的值应始终为 <code>2</code> 。任何值大于或等于 <code>1</code> 都是有效的，但强烈建议不要使用除 <code>2</code> 以外的值以避免兼容性问题。微软的 FAT 驱动程序能正确支持非 2 的值，但一些工具和 FAT 驱动程序会忽略此字段，并假设 FAT 表的数量为 <code>2</code> 。设置为 <code>2</code> 是标准值，用于为 FAT 数据提供冗余。通常从第一个 FAT 表读取条目，并将更改同步到所有 FAT 副本。如果 FAT 区域的某个扇区损坏，数据不会丢失，因为另一份 FAT 中有备份，从而最大程度降低数据丢失风险。在非磁盘存储（如存储卡）中，此冗余功能无意义，因此可将 FAT 表数量设置为 <code>1</code> 来节省空间。但某些 FAT 驱动程序可能无法正确识别此类卷。</td></tr><tr><td><code>BPB_RootEntCnt</code></td><td>17</td><td>2</td><td>在 <code>FAT12/16</code> 卷上，此字段表示根目录中 <code>32</code> 字节目录项的数量。该值应设置为使根目录的大小对齐到扇区的边界，即 <code>BPB_RootEntCnt * 32</code> 是 <code>BPB_BytsPerSec</code> 的整倍数。为最大兼容性， <code>FAT16</code> 卷上此字段应设置为 <code>512</code> 。在 <code>FAT32</code> 卷上，此字段必须为 <code>0</code> 。</td></tr><tr><td><code>BPB_TotSec16</code></td><td>19</td><td>2</td><td>旧的 <code>16</code> 位字段中卷的总扇区数。该值包括卷的所有四个区域的扇区数。当 <code>FAT12/16</code> 卷的扇区数为 <code>0x10000</code> 或更大时，此字段将设置为无效值 <code>0</code> ，而实际值存储在 <code>BPB_TotSec32</code> 中。在 <code>FAT32</code> 卷中，此字段必须始终为 <code>0</code> 。</td></tr><tr><td><code>BPB_Media</code></td><td>21</td><td>1</td><td>此字段的有效值为 <code>0xF0</code> 、 <code>0xF8</code> 、 <code>0xF9</code> 、 <code>0xFA</code> 、 <code>0xFB</code> 、 <code>0xFC</code> 、 <code>0xFD</code> 、 <code>0xFE</code> 和 <code>0xFF</code> 。 <code>0xF8</code> 是非可移动磁盘的标准值， <code>0xF0</code> 常用于未分区的可移动磁盘。另一个重要点是，同样的值必须设置在 <code>FAT[0]</code> 的低 <code>8</code> 位。这源于 MS-DOS 1.0 的媒体确定方法，但现在不再有任何实际用途。</td></tr><tr><td><code>BPB_FATSz16</code></td><td>22</td><td>2</td><td>FAT 表占用的扇区数。此字段仅适用于 <code>FAT12/16</code> 卷。在 <code>FAT32</code> 卷上，该字段必须是无效值 <code>0</code> ，改用 <code>BPB_FATSz32</code> 。 <code>FAT</code> 区域的大小为 <code>BPB_FATSz?? * BPB_NumFATs</code> 扇区。</td></tr><tr><td><code>BPB_SecPerTrk</code></td><td>24</td><td>2</td><td>每磁道的扇区数。此字段仅与具有几何结构的介质相关，并且仅用于 IBM PC 的磁盘 BIOS。</td></tr><tr><td><code>BPB_NumHeads</code></td><td>26</td><td>2</td><td>磁头数量。此字段仅与具有几何结构的介质相关，并且仅用于 IBM PC 的磁盘 BIOS。</td></tr><tr><td><code>BPB_HiddSec</code></td><td>28</td><td>4</td><td>FAT 卷前的隐藏物理扇区数。通常与 IBM PC 磁盘 BIOS 访问的存储相关，此字段的值取决于平台。如果卷从存储的起始处开始（如未分区磁盘，例如软盘），此字段应始终为 <code>0</code> 。</td></tr><tr><td><code>BPB_TotSec32</code></td><td>32</td><td>4</td><td>新的 <code>32</code> 位字段中 FAT 卷的总扇区数。该值包括卷的所有四个区域的扇区数。当 <code>FAT12/16</code> 卷的扇区数小于 <code>0x10000</code> 时，此字段必须为无效值 <code>0</code> ，而实际值存储在 <code>BPB_TotSec16</code> 中。在 FAT32 卷中，此字段始终有效，而旧字段不再使用。</td></tr><tr><td><code>BPB_FATSz32</code></td><td>36</td><td>4</td><td>FAT 表的大小（以扇区为单位）。 <code>FAT</code> 区域的总大小为 <code>BPB_FATSz32 * BPB_NumFATs</code> 扇区。 此字段是唯一一个需要在确定 FAT 类型前被引用的字段，但该字段仅存在于 <code>FAT32</code> 卷中。</td></tr><tr><td><code>BPB_ExtFlags</code></td><td>40</td><td>2</td><td>扩展标志位，用于管理 FAT 表的活动状态和镜像。<br>Bit3-0: 活动 FAT，从 0 开始计数。当 Bit7 为 1 时有效。<br>Bit6-4: 保留位（应设置为 0）。<br>Bit7: <code>0</code> : 所有 FAT 表都处于活动状态并被镜像。 <code>1</code> : 仅由 Bit3-0 指定的 FAT 表处于活动状态。<br>Bit15-8-4: 保留位（应设置为 0）。</td></tr><tr><td><code>BPB_FSVer</code></td><td>42</td><td>2</td><td><code>FAT32</code> 版本号。高字节为主版本号，低字节为次版本号。此字段为 <code>FAT32</code> 文件系统未来扩展预留，实际 <code>FAT32</code> 卷的更新已停止，所以这里一直是默认值 <code>0.0</code> 。</td></tr><tr><td><code>BPB_RootClus</code></td><td>44</td><td>4</td><td>根目录的第一个簇号。通常设置为 <code>2</code> （即卷的第一个簇），但不一定总是 <code>2</code> 。</td></tr><tr><td><code>BPB_FSInfo</code></td><td>48</td><td>2</td><td><code>FSInfo</code> 结构的扇区偏移量（相对于 <code>FAT32</code> 卷的起始位置）。通常设置为 <code>1</code> ，即位于引导扇区的下一个扇区。</td></tr><tr><td><code>BPB_BkBootSec</code></td><td>50</td><td>2</td><td>备份引导扇区的扇区偏移量（相对于 <code>FAT32</code> 卷的起始位置）。通常设置为 <code>6</code> ，即紧邻引导扇区的位置。不推荐设置其他值。</td></tr><tr><td><code>BPB_Reserved</code></td><td>52</td><td>12</td><td>保留字段，必须填充为 0。</td></tr><tr><td><code>BS_DrvNum</code></td><td>64</td><td>1</td><td>磁盘 BIOS 使用的驱动器编号，适用于 IBM PC。此字段在 MS-DOS 启动加载程序中使用：<br><code>0x00</code> : 软盘驱动器<br><code>0x80</code> : 固定磁盘（硬盘）<br>实际上此值取决于操作系统。</td></tr><tr><td><code>BS_Reserved</code></td><td>65</td><td>1</td><td>保留字段，Windows NT 使用。创建卷时，此字段应设置为 <code>0</code> 。</td></tr><tr><td><code>BS_BootSig</code></td><td>66</td><td>1</td><td>扩展引导签名（值为 <code>0x29</code> ）。此签名字节表示接下来的三个字段（ <code>BS_VolID</code> 、 <code>BS_VolLab</code> 和 <code>BS_FilSysType</code> ）存在。</td></tr><tr><td><code>BS_VolID</code></td><td>67</td><td>4</td><td>卷序列号，与 <code>BS_VolLab</code> 配合使用，用于在可移动存储介质上跟踪卷。<br>FAT 驱动程序通过此字段检测错误的媒体更换。通常在格式化时，根据当前时间和日期自动生成。</td></tr><tr><td><code>BS_VolLab</code></td><td>71</td><td>11</td><td>卷的 11 字节标签，需与根目录中记录的卷标签匹配。<br>当根目录中的卷标签发生更改时，FAT 驱动程序应更新此字段。 MS-DOS 会自动更新此字段，但 Windows 不会更新。 如果卷标签不存在，应设置为 <code>&quot;NO NAME &quot;</code> （共 11 字节，右侧填充空格）。</td></tr><tr><td><code>BS_FilSysType</code></td><td>82</td><td>8</td><td>文件系统类型字符串，通常为 <code>&quot;FAT12&quot;</code> , <code>&quot;FAT16&quot;</code> ， <code>&quot;FAT32&quot;</code> 或 <code>&quot;FAT &quot;</code> 。<br>许多人误认为此字符串影响 FAT 类型的确定，实际上这是一个误解。 从字段名称可知，它并不属于 <code>BPB</code> （BIOS 参数块）。 此字符串经常被设置不正确或未设置，因此 Microsoft 的 FAT 驱动程序不会使用此字段来确定 FAT 类型。 然而，一些旧的 FAT 驱动程序依赖此字段来确定 FAT 类型，因此，为避免兼容性问题，应该根据卷的 FAT 类型正确设置此字段。</td></tr><tr><td><code>BS_BootCode32</code></td><td>90</td><td>420</td><td>引导程序。它与平台有关，不使用时填充 <code>0</code> 。</td></tr><tr><td><code>BS_Sign</code></td><td>510</td><td>2</td><td>应为固定值 <code>0xAA55</code> ，表示这是一个有效引导扇区的引导签名。</td></tr><tr><td></td><td>512</td><td></td><td>当扇区大小大于 <code>512</code> 字节时，扇区中的其余部分应为零。</td></tr></tbody></table><p>我们来看一个实例并解释一些重点自动</p><p><img data-src="http://imgcdn.gality.cn/blog/eadc7.png" alt="Boot Loader Sector"></p><ol><li><code>0xEB 0x58 0x90</code> ：汇编指令跳转到 <code>0x58</code> 偏移处，这个偏移是相对于当前指令的，所以加上本身 <code>0xEB 0x58</code> 这两个字节指令，正好跳转到 <code>0x5A</code> 处找到引导程序的开头，也就是标号 10 的位置。</li><li>扇区大小为 <code>0x200</code> 也就是 <code>512</code> 字节。14983*2+2802=</li><li>一个簇内含有 <code>0x10</code> 个扇区，也就是一个簇中有 <code>16</code> 个扇区.</li><li>保留区域中的扇区数为 <code>0xAF2=2802</code> 个，由于扇区是从 0 开始编号的，也就是说 <code>FAT1</code> 从第 2802 号扇区开始。</li><li>有 <code>2</code> 个 FAT 表。</li><li>FAT 卷前的隐藏物理扇区数为 <code>0x800=2048</code> ，也就是说在 FAT 卷前还有 <code>2048</code> 个物理扇区，即逻辑上的 0 号扇区其实对应着物理磁盘中的第 <code>2048</code> 号扇区。</li><li>FAT 卷的总扇区数为 <code>0x1D4B7D0=30717904</code> 个，总扇区包括 <code>保留区</code> 、 <code>FAT1</code> 、 <code>FAT2</code> 和 <code>DATA</code> 四个分区的所有扇区，是 FAT 卷能管理的所有扇区的数量。</li><li>FAT 表的大小为 <code>0x3A87=14983</code> 个扇区。 <code>FAT表大小 * FAT表个数 + 保留区大小 = DATA区开始地址</code> 。</li><li>卷序列号为 <code>0x2AEB8680</code> ，用于在可移动存储介质上跟踪卷。</li></ol><h4 id="一些计算"><a class="anchor" href="#一些计算">#</a> 一些计算</h4><p>每一个区域的偏移和大小都是由 BPB 参数计算出来的：</p><ul><li><p><strong>FAT 区</strong>在保留区的后面，其位置和大小（扇区数）的计算为：</p><figure class="highlight txt"><figcaption data-lang="txt"></figcaption><table><tr><td data-num="1"></td><td><pre>Fat1StartSector = BPB_ResvdSecCnt;</pre></td></tr><tr><td data-num="2"></td><td><pre>FatSectors = BPB_FATSz32 * BPB_NumFATs;</pre></td></tr></table></figure></li><li><p><strong>FAT2 区</strong>在 <code>FAT1</code> 区的后面，其位置和大小（扇区数）的计算为：</p><figure class="highlight txt"><figcaption data-lang="txt"></figcaption><table><tr><td data-num="1"></td><td><pre>Fat2StartSector = BPB_ResvdSecCnt + FatSectors;</pre></td></tr><tr><td data-num="2"></td><td><pre>Fat2Sectors = FatSectors = BPB_FATSz32 * BPB_NumFATs;</pre></td></tr></table></figure></li><li><p><strong>DATA 区</strong>在所有 FAT 区的后面，其位置和大小（扇区数）的计算为：</p><figure class="highlight txt"><figcaption data-lang="txt"></figcaption><table><tr><td data-num="1"></td><td><pre>DataStartSectors = BPB_FATSz32 * BPB_NumFATs + BPB_ResvdSecCnt;</pre></td></tr><tr><td data-num="2"></td><td><pre>DataSectors = BPB_TotSec32 - DataStartSectors;</pre></td></tr></table></figure></li><li><p>如果 <code>FAT卷</code> 不是从硬盘的第一个扇区开始的，那么 <code>FAT卷</code> 中的每个扇区对应的物理扇区为： <code>BPB_HiddSec + 逻辑扇区</code></p></li></ul><h4 id="fsinfo信息扇区"><a class="anchor" href="#fsinfo信息扇区">#</a> FSINFO 信息扇区</h4><p><code>FAT32</code> 在保留区中增加了一个 <code>FSINFO</code> 扇区，用以记录文件系统中空闲簇的数量以及下一可用簇的簇号等信息，使得操作系统可以快速找到可用的簇而无需在每次使用时重新扫描整个 <code>FAT卷</code> 。 <code>FSINFO</code> 扇区的位置由 <code>BPB_FSInfo</code> 指定，通常是 <code>1</code> ，也就是 1 号扇区，紧邻着引导扇区，其结构如下：</p><table><thead><tr><th>字段名</th><th>偏移</th><th>大小</th><th>描述</th></tr></thead><tbody><tr><td><code>FSI_LeadSig</code></td><td>0</td><td>4</td><td>固定值 <code>0x41615252</code> ，引导签名，用于验证该扇区确实是一个 FSInfo 扇区。</td></tr><tr><td><code>FSI_Reserved1</code></td><td>4</td><td>480</td><td>保留字段。此字段应始终初始化为零。</td></tr><tr><td><code>FSI_StrucSig</code></td><td>484</td><td>4</td><td>固定值 <code>0x61417272</code> ，另一个签名，更加局部地标识了与该扇区中使用的字段相关的位置。</td></tr><tr><td><code>FSI_Free_Count</code></td><td>488</td><td>4</td><td>表示卷上最后一次更新后已知的空闲簇数。如果该值为 <code>0xFFFFFFFF</code> ，则表示空闲簇数未知。<br>这不一定是正确的，因此 <code>FAT</code> 驱动程序需要确保该值对卷是有效的。</td></tr><tr><td><code>FSI_Nxt_Free</code></td><td>492</td><td>4</td><td>此字段为 FAT 驱动程序提供一个提示，指示驱动程序应从哪个簇开始查找空闲簇。 由于 <code>FAT32</code> 的 <code>FAT</code> 很大，如果开始查找时有很多已分配的簇，则从 FAT 卷的第一个簇开始查找空闲簇可能会非常耗时。 通常，此值设置为驱动程序上次分配的最后一个簇号。如果值为 <code>0xFFFFFFFF</code> ，则表示没有提示，驱动程序应从簇 2 开始查找。 此值可能不准确，因此 FAT 驱动程序需要确保它对卷是有效的。</td></tr><tr><td><code>FSI_Reserved2</code></td><td>496</td><td>12</td><td>保留字段。此字段应始终初始化为零。</td></tr><tr><td><code>FSI_TrailSig</code></td><td>508</td><td>4</td><td>固定值 <code>0xAA550000</code> ，结尾签名，用于验证该扇区确实是一个 <code>FSInfo</code> 扇区。</td></tr><tr><td></td><td>512</td><td></td><td>如果扇区大小大于 512 字节，则其余字节应初始化为零。</td></tr></tbody></table><p>一个详细的示例如下：</p><p><img data-src="http://imgcdn.gality.cn/blog/29170.png" alt="FSINFO Sector"></p><ol><li>FAT 卷最后一次更新后已知的空闲簇数为 <code>0x1817A8=1578920</code> 个。也即还有 82% 的空余。</li><li>最靠前的一个空闲簇号为 <code>0x2BDB=11227</code> 号。</li></ol><h4 id="2号扇区"><a class="anchor" href="#2号扇区">#</a> 2 号扇区</h4><p>有关 2 号扇区的内容网络上的描述比较少，似乎 FAT 文件系统标准中并没有对 2 号扇区做太多规范，唯一的规范是，由于其仍属于引导扇区的一部分，所以该扇区结尾 4 个字节仍必须是引导扇区签名 <code>0xAA550000</code> 。然而在现在文件系统中，该扇区一般会存放一些 0 号扇区中放不下的引导加载程序的一些额外代码，该部分的代码会在 0 号扇区中通过 <code>jmp 400h</code> 的汇编指令直接跳转到达，该部分的代码也可以在 Intel 80386 实模式下的 16 位模式进行反汇编。</p><p><img data-src="http://imgcdn.gality.cn/blog/d6152.png" alt="second sector"></p><h3 id="备份引导扇区"><a class="anchor" href="#备份引导扇区">#</a> 备份引导扇区</h3><p><code>FAT32</code> 中会将引导扇区的 3 个扇区都做一份备份用于冗余，当主引导扇区损坏时可以通过备份引导扇区恢复文件系统，备份引导扇区的位置由 0 号扇区中的 <code>BPB_BkBootSec</code> 字段指定，一般是 <code>6</code> ，也就是从 <code>6</code> 号扇区开始。 <code>6</code> 、 <code>8</code> 号扇区的内容是 <code>0</code> 、 <code>2</code> 号扇区的原样拷贝，然而第 <code>7</code> 号扇区，也就是 <code>FSINFO</code> 的备份扇区的内容与原扇区内容不太一样，是该扇区的未初始化版本，也就是说当操作系统使用备份扇区时需要重新搜索空间簇数量和位置，这也是非常合理的，当发生硬盘损坏时原本的空闲簇信息可能也不在可靠了，需要重新搜索。</p><p><img data-src="http://imgcdn.gality.cn/blog/1406b.png" alt="FSINFO Backup Sector"></p><h3 id="保留扇区"><a class="anchor" href="#保留扇区">#</a> 保留扇区</h3><p>保留区的剩下扇区都时保留扇区，供使用者灵活使用。</p><h2 id="fat32-fat-区"><a class="anchor" href="#fat32-fat-区">#</a> FAT32 FAT 区</h2><p>FAT 区位于保留区后，一般是两个完全相同的 FAT（File Allocation Table，文件分配表）表组成， FAT 文件系统的名字也是因此而来。</p><p>FAT 文件系统之所以有 12，16，32 不同的版本之分，其根本在于 FAT 表项用来记录一簇空间所占用的二进制位数。以 <code>FAT16</code> 为例，每一簇在 FAT 表中占据 <code>16 bit</code> （2 字节）。所以，FAT16 最大可以表示的簇号为 <code>0xFFFF</code> （ <code>65535</code> ），如果以 <code>32K</code> （最多只支持 64 个扇区）为簇的大小的话， <code>FAT16</code> 可以管理的最大磁盘空间为： <code>32KB×65535=2048MB</code> ，这就是为什么 <code>FAT16</code> 不支持超过 <code>2GB</code> 分区的原因（DOS 下）。注意：</p><ul><li>对于文件系统来说，FAT 表有两个重要作用：描述簇的分配状态以及标明文件或目录的下一簇的簇号。</li><li>通常情况下，一个 FAT 文件系统会有两个 FAT 表，但有时也允许只有一个 FAT 表，FAT 表的具体个数记录在引导扇区的 <code>BPB_NumFATs</code> 字段处。</li><li><code>FAT32</code> 的 FAT 表由一系列大小相等的 FAT 表项组成，每个表项占 <code>32bit</code> （4 字节）。表项从 FAT 区的起始位置开始进行编号，FAT 区第一个扇区的头 4 个字节为 0 号地址，依次类推。0 号地址与 1 号地址被系统保留并存储特殊标志内容，从 2 号表项开始，每个地址对应一个数据区的簇号，FAT 表中的地址编号与数据区中的簇号相同。</li></ul><p>FAT 表的每个条目记录如下 5 种信息中的一种：</p><ol><li>文件下一个簇的地址</li><li>一个特殊的<strong>簇链结束符</strong>（<strong>EOC</strong>，End Of Cluster-chain，或称 End Of Chain）符号指示文件的结束</li><li>一个特殊的符号标示坏簇</li><li>一个特殊的符号标示保留簇</li><li>0 来表示空闲簇</li></ol><p>其条目值得具体规范如下：</p><table><thead><tr><th>FAT 32 表项值</th><th>描述</th></tr></thead><tbody><tr><td><code>0x?0000000</code></td><td>空闲簇</td></tr><tr><td><code>0x?0000001</code></td><td>保留簇</td></tr><tr><td><code>0x?0000002 - 0x?FFFFFEF</code></td><td>被占用的簇；指向下一个簇</td></tr><tr><td><code>0x?FFFFFF0 - 0x?FFFFFF6</code></td><td>保留值</td></tr><tr><td><code>0x?FFFFFF7</code></td><td>簇中含有坏扇区，会将整个簇标记为坏簇</td></tr><tr><td><code>0x?FFFFFF8 - 0x?FFFFFFF</code></td><td>文件最后一个簇</td></tr></tbody></table><p>⚠️ 注意 <code>FAT32</code> 只使用 32 位中的 <code>28位</code> 。高 4 位通常是 <code>0</code> ，但它们是保留位，不要更改它们。在上面的表中它们用<strong>问号</strong>表示。</p><p>一个具体的例子如下：</p><p><img data-src="http://imgcdn.gality.cn/blog/491ba.png" alt="FAT"></p><ol><li>0 号表项（标号 1）的值总是 <code>0x0FFFFFF8</code> 。</li><li>1 号表项（标号 2）可能被用于记录脏标志，以说明文件系统没有被正常卸载或者磁盘表面存在错误。不过这个值并不重要。正常情况下 1 号表项的值为 <code>0xFFFFFFFF</code> 或 <code>0xFFFFFFF</code> 。</li><li>如果某个簇<strong>未被分配使用</strong>，它所对应的表项值即用 <code>0</code> 进行填充，表示该 FAT 表 项所对应的簇未被分配。当某个簇<strong>已被分配使用</strong>时，则它对应的表项值是该文件的下一个存储位置的簇号。如果该文件结束于该簇，则在它的 FAT 表项中记录的是一个文件结束标记，对于 FAT32 而言，代表文件结束的 FAT 表项值为 <code>0x0FFFFFFF</code> 。这里的标志说明 2 号簇内的文件比较小，单独一个 2 号簇的空间就已经可以存储整个文件了。</li><li>7 号簇的表项值说明该簇内存储的文件非常大，一个簇存储不下，存储不下的内容需要去 <code>0x8</code> 号簇去寻找，依次类推，直到找到一个簇的表项值为文件结束标志。</li></ol><p>当文件系统被创建，也就是进行格式化操作时，分配给 FAT 区域的空间将会被清空，然后在 <code>FAT1</code> 与 <code>FAT2</code> 的 0 号表项与 1 号表项写入上述特定值。由于创建文件系统的同时也会创建根目录，也就是为根目录分配了一个簇空间，通常为 2 号簇，所以 2 号簇所对应的 2 号 FAT 表项也会被写入一个结束标记。如果某个簇存在<strong>坏扇区</strong>，则整个簇会用 FAT 表项值 <code>0xFFFFFFF7</code> 标记为坏簇，不再使用，这个坏簇 标记就记录在它所对应的 FAT 表项中。</p><div class="note primary no-icon"><p><strong>新建文件 / 目录过程</strong></p><ul><li>在文件系统中<strong>新建文件</strong>时，如果新建的文件只占用一个簇，为其分配的簇对应的 FAT 表项将会写入结束标记。如果新建的文件不只占用一个簇，则在其所占用的每个簇对应的 FAT 表项中写入为其分配的下一簇的簇号，在最后一个簇对应的 FAT 表象中写入结束标记。</li><li><strong>新建目录</strong>时，只为其分配一个簇的空间，对应的 FAT 表项中写入结束标记。当目录增大超出一个簇的大小时，将会在空闲空间中继续为其分配一个簇，并在 FAT 表中为其建立 FAT 表链以描述它所占用的簇情况。</li></ul><p>更加详细的过程可以看<a href="https://gality.cn/os/fs/FAT32/#fat32-%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B"> FAT32 工作过程</a></p></div><h2 id="fat32-data区"><a class="anchor" href="#fat32-data区">#</a> FAT32 DATA 区</h2><p>数据区时真正用于存放用户数据的区域。数据区紧跟在 FAT2 之后，被划分成一个个的簇。所有的簇 从 2 开始进行编号。也就是说，2 号簇的起始位置就是数据区的起始位置。</p><h3 id="目录表"><a class="anchor" href="#目录表">#</a> 目录表</h3><p><strong>目录表</strong>是一个表示目录的特殊类型文件（现今通常称为文件夹）。它里面保存的每个文件或目录使用表中的 <code>32字节</code> 条目表示。每个条目记录名字、扩展名、属性（档案、目录、隐藏、只读、系统和卷）、创建的日期和时间、文件／目录数据第一个簇的地址，最后是文件／目录的大小。在 <code>FAT32</code> 中所有目录表都存在数据区域（DATA 区）中。目录表项遵循以下格式：</p><table><thead><tr><th>字段名</th><th>偏移</th><th>大小</th><th>描述</th></tr></thead><tbody><tr><td><code>DIR_Name</code></td><td>0</td><td>11</td><td>短文件名（包括文件名和扩展名， <code>8-11</code> 位为文件扩展名，使用空格补齐）<br>第一个字节可以是下面的特殊数值：<br>- 0x00：这个条目未使用并且后面没有被占用条目（后面所有条目该项也为 0）<br>- 0x05：最初字符确实是 0xE5 时使用该值替代<br>- 0x2E：' 点 ' 条目；'.' 或者 '..'<br>- 0xE5：这个条目曾经被删除不再有用。取消删除文件工具作为取消删除的一步必须使用一个正常的字符取代它。</td></tr><tr><td><code>DIR_Attr</code></td><td>11（0B）</td><td>1</td><td>文件属性标志位（高 <code>2</code> 位是保留位且必须置为 0）<br>- <code>0x01</code> ：只读<br>- <code>0x02</code> ：隐藏<br>- <code>0x04</code> ：系统<br>- <code>0x08</code> ：卷标<br>- <code>0x10</code> ：子目录<br>- <code>0x20</code> ：档案（只要完成了写操作并已关闭，则该位置位 1）<br>- <code>0x0F</code> : 长文件条目（Long File Name Entry，LFN Entry）</td></tr><tr><td><code>DIR_NTRes</code></td><td>12（0C）</td><td>1</td><td>NT 保留标志，指示短文件名 (SFN) 的大小写信息：<br>- <code>0x08</code> : 名称主体中的所有字母均为小写。<br>- <code>0x10</code> : 扩展名中的所有字母均为小写。</td></tr><tr><td><code>DIR_CrtTimeTenth</code></td><td>13（0D）</td><td>1</td><td>与 <code>DIR_CrtTime</code> 对应的子秒信息（可选）。 <code>DIR_CrtTime</code> 的时间分辨率为 2 秒，因此此字段以 10 毫秒为单位表示子秒计数，其有效值范围为 0 到 199。如果不支持，则将其设置为 0，并且之后不要更改。</td></tr><tr><td><code>DIR_CrtTime</code></td><td>14</td><td>2</td><td>文件创建时间（可选）。如果不支持，则将其设置为 0，并且之后不要更改。小时、分钟和秒根据后面的图示描述进行编码：<br>- <code>15-11位</code> ：小时（0-23）<br>- <code>10-5位</code> ：分钟（0-59）<br>- <code>4-0位</code> ：秒 / 2 （0-29）</td></tr><tr><td><code>DIR_CrtDate</code></td><td>16</td><td>2</td><td>文件创建日期（可选）。如果不支持，则将其设置为 0，并且之后不要更改。年、月和日根据后面的图示编码：<br>- <code>15-9位</code> ：年（0 = 1980, 127 = 2107）<br>- <code>8-5位</code> ： 月（1 =1 月， 12 = 12 月）<br>- <code>4-0位</code> ：日（1 - 31）</td></tr><tr><td><code>DIR_LstAccDate</code></td><td>18</td><td>2</td><td>文件最近访问日期（可选）。分辨率为 1 天。 如果不支持，则将其设置为 0，并且之后不要更改。</td></tr><tr><td><code>DIR_FstClusHI</code></td><td>20</td><td>2</td><td>簇号的高 16 位。在 FAT12/16 卷上始终为零。</td></tr><tr><td><code>DIR_WrtTime</code></td><td>22</td><td>2</td><td>文件的最后写入时间（通常在文件关闭时更新），编码格式与 <code>DIR_CrtTime</code> 相同。</td></tr><tr><td><code>DIR_WrtDate</code></td><td>24</td><td>2</td><td>文件的最后写入日期（通常在文件关闭时更新），编码格式与 <code>DIR_CrtDate</code> 相同。</td></tr><tr><td><code>DIR_FstClusLO</code></td><td>26</td><td>2</td><td>簇号的低 16 位。当文件大小为 0 时，不分配簇，此项必须为 0。 如果是目录，则此值始终为有效值。</td></tr><tr><td><code>DIR_FileSize</code></td><td>28</td><td>4</td><td>文件的大小，以字节为单位。如果是目录，此字段未使用，并且其值必须始终为 0。</td></tr></tbody></table><p>当 <code>DIR_Attr</code> 为 <code>0x0F</code> 时，该目录表的字段含义为：</p><table><thead><tr><th>字段名</th><th>偏移</th><th>大小</th><th>描述</th></tr></thead><tbody><tr><td><code>LDIR_Ord</code></td><td>0</td><td>1</td><td>序号 (1-20)，用于标识此条目在组成 LFN 的所有条目中的位置。 <code>0x01</code> 表示 LFN 的起始部分。任何带有 <strong>LAST_LONG_ENTRY</strong> 标志 ( <code>0x40</code> ) 的值表示 LFN 的最后一部分。</td></tr><tr><td><code>LDIR_Name1</code></td><td>1</td><td>10</td><td>文件名的第 1-5 个字符（UTF-16），未使用的部分先填充两个字节的 <code>0x00</code> ，然后用 <code>0xFF</code> 填充。</td></tr><tr><td><code>LDIR_Attr</code></td><td>11</td><td>1</td><td>LFN 目录属性标志 <code>0x0F</code></td></tr><tr><td><code>LDIR_Type</code></td><td>12</td><td>1</td><td>保留未使用</td></tr><tr><td><code>LDIR_Chksum</code></td><td>13</td><td>1</td><td>文件名校验和</td></tr><tr><td><code>LDIR_Name2</code></td><td>14</td><td>12</td><td>文件名的第 6-11 个字符（UTF-16），未使用的部分先填充两个字节的 <code>0x00</code> ，然后用 <code>0xFF</code> 填充。</td></tr><tr><td><code>LDIR_FstClusLO</code></td><td>26</td><td>2</td><td>保留</td></tr><tr><td><code>LDIR_Name3</code></td><td>28</td><td>4</td><td>文件名的第 12-13 个字符（UTF-16），未使用的部分先填充两个字节的 <code>0x00</code> ，然后用 <code>0xFF</code> 填充。</td></tr></tbody></table><p>一个实例如下：</p><p><img data-src="http://imgcdn.gality.cn/blog/50a89.png" alt=""></p><ol><li><p>通过绿色的 <code>0x08</code> 标志确定第一个目录项类型为卷标，即该 FAT 卷标名为 <code>UBUNTU-SERV</code> ，实际情况也确实如此，该 U 盘为 Ubuntu-24.04 的系统盘。一般来说卷标名存储在 DATA 数据区的开头，我们也可以计算一下进行验证，DATA 区的地址应该为 <code>0x200 * (FAT区扇区数 * 2 + 保留区扇区数) = 0x1000000</code> ，与实际相符。同时我们也可以计算出该卷最后一次修改的时间与日期：</p><p>时间： <code>0x9E55 = (10011)(110 010)(10101)</code> 即 <code>(19):(50):(21*2)</code> ，也就是 19:50:42。</p><p>年份： <code>0x596B = (0101100)(1 011)(01011)</code> 即 <code>(44)(11)(11)</code> ，也就是 2024 年 11 月 11 日。</p><p>注意：卷标目录项结构与普通短文件名目录项结构完全相同，但没有创建时间和访问时间，只有一个<strong>最后修改时间</strong>。另外，卷标目录项也没有簇号和大小值，这些字节位置全部这只为 <code>0</code> 。</p></li><li><p>绿色标志位确定这两项都是 <code>LFN</code> 项，LFN 有一些特殊的规则：</p><ul><li><p>如果一个文件的文件名超过了 8 个字符，则会将其名字截短后为其建立短文件名（Short File Name， SFN）。将短文件名存储在短文件名目录项中。长文件名则存放在长文件名目录项中。</p></li><li><p>LFN 项中的文件名使用 UTF-16 编码，存储 13 个 Unicode 字符的文件名，每个字符占用两个字节，如果文件名长于 13 个字符，则继续为其分配 LFN 项，知道够用为止。</p></li><li><p>一个文件的所有 LFN 项按倒序排列在它的 SFN 项前面，即文件名的第一部分距离 SFN 是最近的。</p></li><li><p>LFN 项第一个字节为序号位，距离 SFN 最近的一个 LFN 项序号为 1， 如果后续还有 LFN 项，则依次向后递增为 2， 3，... 最后一个 LFN 块的序号需要异或上 <code>0x40</code> ，在上图中，由于第二个 LFN 项就是最后一个 LFN 项，所以其序号为 <code>0x42 = 0x40 | 0x02</code> 。</p></li><li><p>每个 LFN 条目在 <code>LDIR_Chksum</code> 中都有一个校验和，同一个文件的所有 LFN 项的校验和都相同，此外，校验和还被用于确保 LFN 和 SFN 之间的相关性。校验和的生成算法如下：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">uint8_t</span> <span class="token function">create_sum</span> <span class="token punctuation">(</span><span class="token keyword">const</span> DIR<span class="token operator">*</span> entry<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token class-name">uint8_t</span> sum<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">11</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* Calculate sum of DIR_Name[] field */</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        sum <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>sum <span class="token operator">&lt;&lt;</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">+</span> entry<span class="token operator">-></span>DIR_Name<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class="primary"><summary>我们可以写一个简单的小程序来验证一下</summary><div><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdint.h></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">int</span> i<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token class-name">uint8_t</span> sum<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token class-name">uint8_t</span> DIR_name<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x4D</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">11</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        sum <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>sum <span class="token operator">&lt;&lt;</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">+</span> DIR_name<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"sum = %#X\n"</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// Output: sum = 0X72</span></pre></td></tr></table></figure><p>与棕色标出的校验和一致。</p></div></details></li><li><p>当文件名没有占满一个 LFN 项时，需要先填充两个字节的 <code>0x00</code> ，也就是 <code>0x3E-0x3F</code> 位置的填充的内容，如果仍有空余空间，则应该在所有字符位填充 <code>0xFF</code> 。</p></li></ul></li><li><p>对于短文件名（SFN）目录项来说，如果文件名不足 8 个字符，用 0x20 进行填充。当文件名超过 8 个字符时则会被截短，因为短文件名目录项中没有足够的空间记录超出的部分。截短的方法是取文件名的前 6 个字符加上 <code>~1 (0x7E 0x31)</code> （如果有同名文件，则会依次递增该数值），然后加上其扩展名。这里绿色标志位确定改项为一个子目录项，且具有两个属性：隐藏和系统。当目录项类型为子目录时，则将扩展名部分用 “0x20” 进行填充。</p><p>可以看到该子目录所在簇号为 3 号，由于在该文件系统中一个簇包含 16 个扇区，所以在 <code>0x10020000</code> 偏移处就是 3 号簇，其中记录着 <code>System Volume Information</code> 目录内的内容。</p></li></ol><p><strong>注意</strong>：从 windows95 开始，不管文件名的长度是否超过 8 个字符，都会<ins class="wavy">同时为其创建 SFN 目录项和 LFN 目录项</ins> ，因为短文件名不区分大小写，而长文件名则是区分大小写的。这一点也可以在下列的 <code>[boot]</code> 子目录项的格式中得到验证。（之所以在 SFN 中 <code>[boot]</code> 被替换为 <code>_BOOT_</code> 是因为 <code>[]</code> 并不是合法的 DOS 文件名字符，所以发生了替换，合法的 DOS 字符包括：</p><figure class="highlight txt"><figcaption data-lang="txt"></figcaption><table><tr><td data-num="1"></td><td><pre>0～9 A～Z ! # $ % &amp; ' ( ) - @ ^ _  \` &#123; &#125; ~</pre></td></tr></table></figure><h1 id="fat32-工作过程"><a class="anchor" href="#fat32-工作过程">#</a> FAT32 工作过程</h1><h2 id="建立文件"><a class="anchor" href="#建立文件">#</a> 建立文件</h2><p>假设在跟目录下由一个子目录，名字为 <code>test</code> ，我们要在其下建立一个文件 <code>example.txt</code> 。使用 <code>FAT32</code> 文件系统，一个簇的大小为 <code>4096</code> 字节（一个簇 <code>8</code> 个扇区，每个扇区 <code>512</code> 字节），我们要建立的文件大小为 <code>5000</code> 字节。步骤如下：</p><ol><li>读取位于卷 0 号扇区的引导扇区，根据引导扇区中的信息定位 FAT 表、数据区和根目录的位置。</li><li>查看根目录下的每个目录项，寻找名字为 <code>test</code> 且具有目录属性的目录项。找到后，查看它的起始簇号为 3。</li><li>读取 3 号簇的内容，查找每个目录项，直到找到一个未分配的目录项（第一个字节为 <code>0x00</code> ）。</li><li>找到可用项后写入文件名 “example.txt”，并将文件大小和当前时间写入相应的位置。</li><li>为文件内容分配簇空间。转到 FAT 表，寻找空闲的位置。发现 4 号 FAT 表项未使用，这就说明 4 号簇是空闲的。将 4 号簇分配给文件，并在 4 号簇的 FAT 表项内写入结束标记。</li><li>将簇号 4 写入 <code>example.txt</code> 文件目录项的起始簇号区域。将文件的前 4096 字节写入到 4 号簇中，还剩下 <code>904</code> 字节，所以还需要再为其分配一个簇。</li><li>在 FAT 表中继续寻找未分配簇，找到 5 号簇为空闲未使用（ FAT 表项为 0）。</li><li>将 <code>example.txt</code> 的第一个簇（即 4 号簇）的 FAT 表项值改写为 5，将文件的最后 <code>904</code> 字节写入 5 号簇。</li><li>在 5 号簇的 FAT 表项内写入结束标记。</li></ol><h2 id="删除文件"><a class="anchor" href="#删除文件">#</a> 删除文件</h2><p>将我们之前创建的 <code>/test/example.txt</code> 文件删除。步骤如下：</p><ol><li>从卷 0 号扇区读取引导扇区，根据引导扇区中的信息定位 FAT 表、数据区和根目录的位置。</li><li>在根目录下寻找名字为 <code>test</code> 且具有目录属性的目录项。</li><li>：由 <code>test</code> 的目录项中获取它的起始簇号为 3，到 3 号簇查看 <code>test</code> 文件夹内的内容，从中找到文件 <code>example.txt</code> 的目录项，提取出它的起始簇号，为 4 号簇。</li><li>到 FAT 表中找到该文件的簇链，确定他的存储位置为 4 号簇和 5 号簇。</li><li>将 4 号簇和 5 号簇的 FAT 项设置为 0，表示这两个簇未被占用，可以被重新分配。</li><li>将文件 <code>example.txt</code> 的目录项的第一个字节改为 <code>0xE5</code> 。</li></ol><h2 id="索引文件"><a class="anchor" href="#索引文件">#</a> 索引文件</h2><p>索引文件的过程其实就是删除文件的前 4 步，比较简单，就不赘述了。</p><br><div class="tags"><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" rel="tag"><i class="ic i-tag"></i> 操作系统</a> <a href="/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" rel="tag"><i class="ic i-tag"></i> 文件系统</a> <a href="/tags/FAT32/" rel="tag"><i class="ic i-tag"></i> FAT32</a> <a href="/tags/FAT/" rel="tag"><i class="ic i-tag"></i> FAT</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2024-12-24 17:07:48" itemprop="dateModified" datetime="2024-12-24T17:07:48+08:00">2024-12-24</time> </span><span id="os/fs/FAT32/" class="item leancloud_visitors" data-flag-title="文件系统详解 ｜ FAT32" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/images/wechatpay.png" alt="Gality 微信支付"><p>微信支付</p></div><div><img data-src="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/images/alipay.png" alt="Gality 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Gality <i class="ic i-at"><em>@</em></i>藏器于身</li><li class="link"><strong>本文链接：</strong> <a href="https://gality.cn/os/fs/FAT32/" title="文件系统详解 ｜ FAT32">https://gality.cn/os/fs/FAT32/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/misc/trail-and-error/CLion-CMake/" itemprop="url" rel="prev" data-background-image="http:&#x2F;&#x2F;imgcdn.gality.cn&#x2F;blog&#x2F;2h6jtq.jpg" title="CLion构建远程CMake开发环境"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 踩坑</span><h3>CLion构建远程CMake开发环境</h3></a></div><div class="item right"><a href="/scientific-research/thesis-reading/JANUS/" itemprop="url" rel="next" data-background-image="http:&#x2F;&#x2F;imgcdn.gality.cn&#x2F;blog&#x2F;14wa89.png" title="论文阅读｜ Fuzzing File Systems via Two-Dimensional Input Space Exploration"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 论文阅读</span><h3>论文阅读｜ Fuzzing File Systems via Two-Dimensional Input Space Exploration</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text">文件系统基本概念</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fat32-%E8%AF%A6%E8%A7%A3"><span class="toc-number">2.</span> <span class="toc-text">FAT32 详解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#fat32-%E6%95%B4%E4%BD%93%E5%B8%83%E5%B1%80"><span class="toc-number">2.1.</span> <span class="toc-text">FAT32 整体布局</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fat32-%E4%BF%9D%E7%95%99%E5%8C%BA"><span class="toc-number">2.2.</span> <span class="toc-text">FAT32 保留区</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%AF%BC%E6%89%87%E5%8C%BAboot-sector"><span class="toc-number">2.2.1.</span> <span class="toc-text">引导扇区（Boot Sector）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E8%AE%A1%E7%AE%97"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">一些计算</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fsinfo%E4%BF%A1%E6%81%AF%E6%89%87%E5%8C%BA"><span class="toc-number">2.2.1.2.</span> <span class="toc-text">FSINFO 信息扇区</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E5%8F%B7%E6%89%87%E5%8C%BA"><span class="toc-number">2.2.1.3.</span> <span class="toc-text">2 号扇区</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E5%BC%95%E5%AF%BC%E6%89%87%E5%8C%BA"><span class="toc-number">2.2.2.</span> <span class="toc-text">备份引导扇区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%9D%E7%95%99%E6%89%87%E5%8C%BA"><span class="toc-number">2.2.3.</span> <span class="toc-text">保留扇区</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fat32-fat-%E5%8C%BA"><span class="toc-number">2.3.</span> <span class="toc-text">FAT32 FAT 区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fat32-data%E5%8C%BA"><span class="toc-number">2.4.</span> <span class="toc-text">FAT32 DATA 区</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E8%A1%A8"><span class="toc-number">2.4.1.</span> <span class="toc-text">目录表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fat32-%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B"><span class="toc-number">3.</span> <span class="toc-text">FAT32 工作过程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B%E6%96%87%E4%BB%B6"><span class="toc-number">3.1.</span> <span class="toc-text">建立文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6"><span class="toc-number">3.2.</span> <span class="toc-text">删除文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E6%96%87%E4%BB%B6"><span class="toc-number">3.3.</span> <span class="toc-text">索引文件</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/os/fs/FAT32/" rel="bookmark" title="文件系统详解 ｜ FAT32">文件系统详解 ｜ FAT32</a></li><li><a href="/os/fs/VFS/" rel="bookmark" title="Linux 文件系统模型与VFS入门">Linux 文件系统模型与VFS入门</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Gality" data-src="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/images/avatar.png"><p class="name" itemprop="name">Gality</p><div class="description" itemprop="description">安全杂记 & 日常随感</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">39</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">20</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">54</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0dhbGl0eTM2OQ==" title="https:&#x2F;&#x2F;github.com&#x2F;Gality369"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span> <a href="https://gality.cn/about/" title="https:&#x2F;&#x2F;gality.cn&#x2F;about&#x2F;" class="item about"><i class="ic i-address-card"></i></a> <span class="exturl item email" data-url="bWFpbHRvOjQzNDQwMDcyNkBxcS5jb20=" title="mailto:434400726@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>小伙伴</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>资源</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/misc/trail-and-error/CLion-CMake/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/scientific-research/thesis-reading/JANUS/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/os/" title="分类于 操作系统">操作系统</a> <i class="ic i-angle-right"></i> <a href="/categories/os/fs/" title="分类于 文件系统">文件系统</a></div><span><a href="/os/fs/FAT32/" title="文件系统详解 ｜ FAT32">文件系统详解 ｜ FAT32</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/scientific-research/" title="分类于 科研">科研</a> <i class="ic i-angle-right"></i> <a href="/categories/scientific-research/thesis-reading/" title="分类于 论文阅读">论文阅读</a></div><span><a href="/scientific-research/thesis-reading/JANUS/" title="论文阅读｜ Fuzzing File Systems via Two-Dimensional Input Space Exploration">论文阅读｜ Fuzzing File Systems via Two-Dimensional Input Space Exploration</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ponder/" title="分类于 思考与沉淀">思考与沉淀</a></div><span><a href="/ponder/Gresham-law/" title="劣币驱逐良币 ｜ 一次网购经历的反思">劣币驱逐良币 ｜ 一次网购经历的反思</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/os/" title="分类于 操作系统">操作系统</a> <i class="ic i-angle-right"></i> <a href="/categories/os/kernel/" title="分类于 内核">内核</a></div><span><a href="/os/kernel/build-kernel/" title="从0开始构建Linux内核">从0开始构建Linux内核</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/os/" title="分类于 操作系统">操作系统</a> <i class="ic i-angle-right"></i> <a href="/categories/os/kernel/" title="分类于 内核">内核</a> <i class="ic i-angle-right"></i> <a href="/categories/os/kernel/0-1/" title="分类于 从 0 到 1">从 0 到 1</a></div><span><a href="/os/kernel/02-simplefs/" title="从零实现FS | 最简单的存储结构与格式化工具">从零实现FS | 最简单的存储结构与格式化工具</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ponder/" title="分类于 思考与沉淀">思考与沉淀</a></div><span><a href="/ponder/%E9%9D%A2%E8%AF%95%E5%A4%8D%E7%9B%98/" title="科技协会面试反思与总结">科技协会面试反思与总结</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/misc/" title="分类于 杂项">杂项</a> <i class="ic i-angle-right"></i> <a href="/categories/misc/trail-and-error/" title="分类于 踩坑">踩坑</a></div><span><a href="/misc/trail-and-error/blog%E6%90%AD%E5%BB%BA/" title="blog搭建&amp;Hello world">blog搭建&Hello world</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/os/" title="分类于 操作系统">操作系统</a> <i class="ic i-angle-right"></i> <a href="/categories/os/0-1/" title="分类于 从 0 到 1">从 0 到 1</a></div><span><a href="/os/02-mbr/" title="02-从BIOS启动到MBR编写">02-从BIOS启动到MBR编写</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/misc/" title="分类于 杂项">杂项</a> <i class="ic i-angle-right"></i> <a href="/categories/misc/trail-and-error/" title="分类于 踩坑">踩坑</a></div><span><a href="/misc/trail-and-error/Mac-Latex/" title="Mac下Latex论文一条龙">Mac下Latex论文一条龙</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/misc/" title="分类于 杂项">杂项</a> <i class="ic i-angle-right"></i> <a href="/categories/misc/trail-and-error/" title="分类于 踩坑">踩坑</a></div><span><a href="/misc/trail-and-error/RTX4080-tensorflow2/" title="在 RTX 4080 上运行 tensorflow 2">在 RTX 4080 上运行 tensorflow 2</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2023 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Gality @ Samadhi</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">278k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">8:26</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"os/fs/FAT32/",favicon:{show:"（●´3｀●）哎呀呀～",hide:"(´Д｀)吓死你"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/js/app.js?v=0.2.5"></script></body></html>