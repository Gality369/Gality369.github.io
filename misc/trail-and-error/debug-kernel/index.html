<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="KbCOz5IFs80bU-psVUCv9C7SOLzVWto8d7_5ZSsX7I0"><meta name="baidu-site-verification" content="codeva-KcLqIZYGXd"><link rel="alternate" type="application/rss+xml" title="è—å™¨äºèº«" href="https://gality.cn/rss.xml"><link rel="alternate" type="application/atom+xml" title="è—å™¨äºèº«" href="https://gality.cn/atom.xml"><link rel="alternate" type="application/json" title="è—å™¨äºèº«" href="https://gality.cn/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/css/app.css?v=0.2.5"><meta name="keywords" content="linux,kernel,build,6.8,GDB,QEMU,debug"><link rel="canonical" href="https://gality.cn/misc/trail-and-error/debug-kernel/"><title>GDB+QEMU è°ƒè¯• Linux å†…æ ¸ä¸å†…æ ¸æ¨¡å— - è¸©å‘ - æ‚é¡¹ | Samadhi = è—å™¨äºèº« = å¾…æ—¶è€ŒåŠ¨</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">GDB+QEMU è°ƒè¯• Linux å†…æ ¸ä¸å†…æ ¸æ¨¡å—</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2025-02-04 14:26:12"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" datetime="2025-02-04T14:26:12+08:00">2025-02-04</time> </span><span class="item" title="æœ¬æ–‡å­—æ•°"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">æœ¬æ–‡å­—æ•°</span> <span>9.7k</span> <span class="text">å­—</span> </span><span class="item" title="é˜…è¯»æ—¶é•¿"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">é˜…è¯»æ—¶é•¿</span> <span>18 åˆ†é’Ÿ</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Samadhi</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="http://imgcdn.gality.cn/blog/14wa89.png"></li><li class="item" data-background-image="http://imgcdn.gality.cn/blog/hlzx1w.png"></li><li class="item" data-background-image="http://imgcdn.gality.cn/blog/px3os4.jpg"></li><li class="item" data-background-image="http://imgcdn.gality.cn/blog/2023-08-19-wallhaven-9d28vd_2560x1440.png"></li><li class="item" data-background-image="http://imgcdn.gality.cn/blog/2023-08-19-wallhaven-welokx_1920x1080.png"></li><li class="item" data-background-image="http://imgcdn.gality.cn/blog/7zx56a.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/misc/" itemprop="item" rel="index" title="åˆ†ç±»äº æ‚é¡¹"><span itemprop="name">æ‚é¡¹</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/misc/trail-and-error/" itemprop="item" rel="index" title="åˆ†ç±»äº è¸©å‘"><span itemprop="name">è¸©å‘</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://gality.cn/misc/trail-and-error/debug-kernel/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/images/avatar.png"><meta itemprop="name" content="Gality"><meta itemprop="description" content="å¾…æ—¶è€ŒåŠ¨, å®‰å…¨æ‚è®° & æ—¥å¸¸éšæ„Ÿ"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="è—å™¨äºèº«"></span><div class="body md" itemprop="articleBody"><div class="note primary no-icon"><p>debug æ˜¯å®šä½å¹¶è§£å†³ä»£ç å¼€å‘è¿‡ç¨‹ä¸­é—®é¢˜çš„æœ€å¥½æ–¹æ³•ï¼Œæœ¬ç¯‡æ–‡ç« è®²è§£å¦‚ä½•åˆ©ç”¨ QEMU å’Œ GDB æ¥æ­å»º linux kernel å†…æ ¸åŠå†…æ ¸æ¨¡å—çš„è°ƒè¯•ç¯å¢ƒï¼Œä»¥åŠå¦‚ä½•ç»“åˆ VSCode å®ç°å¸¦ UI çš„è°ƒè¯•ã€‚</p><p>âš™ï¸ ä»¥ä¸‹æ˜¯æœ¬ç¯‡æ–‡ç« æ‰€ä½¿ç”¨çš„ç¯å¢ƒï¼š</p><ul><li>Hostï¼šUbuntu 24.04</li><li>QEMU: 8.2.2</li><li>GDB: 15.0.50</li><li>Linux kernel 6.8.0</li></ul></div><h1 id="ç¼–è¯‘å†…æ ¸"><a class="anchor" href="#ç¼–è¯‘å†…æ ¸">#</a> ç¼–è¯‘å†…æ ¸</h1><div class="note warning"><p>åœ¨ç½‘ä¸Šå¤§å¤šæ•°æ•™ç¨‹ä¸­éƒ½åªè¯´äº†è¦é…ç½® <code>CONFIG_DEBUG_INFO=y</code> ï¼Œä½†å®é™…è¾ƒæ–°ç‰ˆæœ¬çš„ linux å†…æ ¸çš„é…ç½®æ–‡ä»¶ä¸­å¼•å…¥äº† <code>CONFIG_DEBUG_INFO_NONE</code> å­—æ®µï¼Œé»˜è®¤ä¸º <code>CONFIG_DEBUG_INFO_NONE=y</code> ï¼Œè¿™ç§æƒ…å†µ <code>make</code> ä¼šè¦†ç›– <code>CONFIG_DEBUG_INFO=y</code> çš„é€‰é¡¹ï¼Œå¯¼è‡´æ— æ³•ç”Ÿæˆå¸¦è°ƒè¯•çš„ä¿¡æ¯çš„å†…æ ¸ï¼Œæ‰€ä»¥è¯·åŠ¡å¿…æŒ‰ç…§å¦‚ä¸‹æ­¥éª¤è¿›è¡Œé…ç½®ã€‚</p></div><p>é¦–å…ˆåœ¨ linux æºä»£ç ç›®å½•ä¸­æ‰§è¡Œ <code>make defconfig</code> è·å–ä¸€ä¸ªé»˜è®¤çš„ <code>.config</code> é…ç½®ï¼Œç„¶åç”¨ <code>vim .config</code> æ‰“å¼€ <code>.config</code> å¹¶æ‰¾åˆ° <code>CONFIG_DEBUG_INFO_NONE</code> ï¼Œç„¶åè¿›è¡Œå¦‚ä¸‹ä¿®æ”¹ï¼š</p><ul><li><code>CONFIG_DEBUG_INFO_NONE=y</code> â¡ï¸ <code>CONFIG_DEBUG_INFO_NONE=n</code></li><li><code># CONFIG_DEBUG_INFO_DWARF_TOOLCHAIN_DEFAULT is not set</code> â¡ï¸ <code>CONFIG_DEBUG_INFO_DWARF_TOOLCHAIN_DEFAULT=y</code></li></ul><p>ç„¶åä¿å­˜ï¼Œå¹¶æ‰§è¡Œ <code>make</code> ï¼Œä¼šæç¤ºä¸€äº›é…ç½®é—®é¢˜ï¼Œä¸€èˆ¬ç›´æ¥å›è½¦å³å¯ï¼Œä½†æ˜¯å¯ç”¨ <code>GDB_SCRIPTS</code> è¦æ‰‹åŠ¨è®¾ç½®ä¸‹ï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>â¯ <span class="token function">make</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  SYNC    include/config/auto.conf.cmd</pre></td></tr><tr><td data-num="3"></td><td><pre>*</pre></td></tr><tr><td data-num="4"></td><td><pre>* Restart config<span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="5"></td><td><pre>*</pre></td></tr><tr><td data-num="6"></td><td><pre>*</pre></td></tr><tr><td data-num="7"></td><td><pre>* Compile-time checks and compiler options</pre></td></tr><tr><td data-num="8"></td><td><pre>*</pre></td></tr><tr><td data-num="9"></td><td><pre>Debug information</pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token number">1</span>. Disable debug information <span class="token punctuation">(</span>DEBUG_INFO_NONE<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token operator">></span> <span class="token number">2</span>. Rely on the toolchain<span class="token string">'s implicit default DWARF version (DEBUG_INFO_DWARF_TOOLCHAIN_DEFAULT)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  3. Generate DWARF Version 4 debuginfo (DEBUG_INFO_DWARF4)</pre></td></tr><tr><td data-num="13"></td><td><pre>  4. Generate DWARF Version 5 debuginfo (DEBUG_INFO_DWARF5)</pre></td></tr><tr><td data-num="14"></td><td><pre>choice[1-4?]: 2</pre></td></tr><tr><td data-num="15"></td><td><pre>Reduce debugging information (DEBUG_INFO_REDUCED) [N/y/?] (NEW)</pre></td></tr><tr><td data-num="16"></td><td><pre>Compressed Debug information</pre></td></tr><tr><td data-num="17"></td><td><pre>> 1. Don't compress debug information <span class="token punctuation">(</span>DEBUG_INFO_COMPRESSED_NONE<span class="token punctuation">)</span> <span class="token punctuation">(</span>NEW<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token number">2</span>. Compress debugging information with zlib <span class="token punctuation">(</span>DEBUG_INFO_COMPRESSED_ZLIB<span class="token punctuation">)</span> <span class="token punctuation">(</span>NEW<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token number">3</span>. Compress debugging information with zstd <span class="token punctuation">(</span>DEBUG_INFO_COMPRESSED_ZSTD<span class="token punctuation">)</span> <span class="token punctuation">(</span>NEW<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>choice<span class="token punctuation">[</span><span class="token number">1</span>-3?<span class="token punctuation">]</span>:</pre></td></tr><tr><td data-num="21"></td><td><pre>Produce <span class="token function">split</span> debuginfo <span class="token keyword">in</span> .dwo files <span class="token punctuation">(</span>DEBUG_INFO_SPLIT<span class="token punctuation">)</span> <span class="token punctuation">[</span>N/y/?<span class="token punctuation">]</span> <span class="token punctuation">(</span>NEW<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>Provide GDB scripts <span class="token keyword">for</span> kernel debugging <span class="token punctuation">(</span>GDB_SCRIPTS<span class="token punctuation">)</span> <span class="token punctuation">[</span>N/y/?<span class="token punctuation">]</span> <span class="token punctuation">(</span>NEW<span class="token punctuation">)</span> y <span class="token comment"># å…¶ä½™éƒ½æ˜¯é»˜è®¤ï¼Œåªæœ‰è¿™ä¸ªè¦æ‰‹åŠ¨å¼€å¯</span></pre></td></tr><tr><td data-num="23"></td><td><pre>Warn <span class="token keyword">for</span> stack frames larger than <span class="token punctuation">(</span>FRAME_WARN<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">2048</span><span class="token punctuation">]</span> <span class="token number">2048</span></pre></td></tr><tr><td data-num="24"></td><td><pre>Strip assembler-generated symbols during <span class="token function">link</span> <span class="token punctuation">(</span>STRIP_ASM_SYMS<span class="token punctuation">)</span> <span class="token punctuation">[</span>N/y/?<span class="token punctuation">]</span> n</pre></td></tr><tr><td data-num="25"></td><td><pre>Generate readable assembler code <span class="token punctuation">(</span>READABLE_ASM<span class="token punctuation">)</span> <span class="token punctuation">[</span>N/y/?<span class="token punctuation">]</span> n</pre></td></tr><tr><td data-num="26"></td><td><pre>Install uapi headers to usr/include <span class="token punctuation">(</span>HEADERS_INSTALL<span class="token punctuation">)</span> <span class="token punctuation">[</span>N/y/?<span class="token punctuation">]</span> n</pre></td></tr><tr><td data-num="27"></td><td><pre>Enable full Section mismatch analysis <span class="token punctuation">(</span>DEBUG_SECTION_MISMATCH<span class="token punctuation">)</span> <span class="token punctuation">[</span>N/y/?<span class="token punctuation">]</span> n</pre></td></tr><tr><td data-num="28"></td><td><pre>Make section mismatch errors non-fatal <span class="token punctuation">(</span>SECTION_MISMATCH_WARN_ONLY<span class="token punctuation">)</span> <span class="token punctuation">[</span>Y/n/?<span class="token punctuation">]</span> y</pre></td></tr><tr><td data-num="29"></td><td><pre>Force weak per-cpu definitions <span class="token punctuation">(</span>DEBUG_FORCE_WEAK_PER_CPU<span class="token punctuation">)</span> <span class="token punctuation">[</span>N/y/?<span class="token punctuation">]</span> n</pre></td></tr></table></figure><p>å½“é…ç½®å®Œæˆå¹¶å¼€å§‹å‡ºç°ç¼–è¯‘æ—¶ï¼Œæˆ‘ä»¬å…ˆ <code>ctrl+c</code> åœæ­¢ä¸€ä¸‹ï¼Œç„¶åå†æ¬¡ <code>vim .config</code> æ‰“å¼€ <code>.config</code> ï¼Œå¹¶ä½œå¦‚ä¸‹ä¿®æ”¹ï¼š</p><ul><li><code># CONFIG_KGDB is not set</code> â¡ï¸ <code>CONFIG_KGDB=y</code></li><li><code>CONFIG_RANDOMIZE_BASE=y</code> â¡ï¸ <code>CONFIG_RANDOMIZE_BASE=n</code></li><li><code># CONFIG_DEBUG_INFO_REDUCED is not set</code> â¡ï¸ <code>CONFIG_DEBUG_INFO_REDUCED=n</code></li><li>å¦‚æœæ¶æ„æ”¯æŒ CONFIG_FRAME_POINTERï¼Œè¦ä¿æŒå¼€å¯</li></ul><p>ç„¶åä¿å­˜ <code>.config</code> å¹¶å†æ¬¡ <code>make</code> ï¼Œæ­¤æ—¶åˆä¼šæç¤ºä¸€äº›é…ç½®é—®é¢˜ï¼Œå…¨éƒ¨å›è½¦å³å¯ï¼Œå¾…å†…æ ¸ç¼–è¯‘å®Œæˆï¼Œç›®å½•ä¸‹ä¼šç”Ÿæˆä»¥ä¸‹ä¸¤ä¸ªæ–‡ä»¶</p><ul><li><code>./vmLinux</code></li><li><code>./arch/x86/boot/bzImage</code></li></ul><p>å…¶ä¸­ vmLinux ä¸º GDB æ‰€éœ€çš„è°ƒè¯• Map æ–‡ä»¶ï¼ŒbzImage ä¸ºå¤§å†…æ ¸æ–‡ä»¶ï¼Œè‡³æ­¤ï¼Œè¯¥æ­¥éª¤å®Œæˆã€‚</p><h1 id="åˆ¶ä½œqemuå¯åŠ¨ç›˜"><a class="anchor" href="#åˆ¶ä½œqemuå¯åŠ¨ç›˜">#</a> åˆ¶ä½œ qemu å¯åŠ¨ç›˜</h1><h2 id="åŸºæœ¬æ“ä½œç³»ç»Ÿ"><a class="anchor" href="#åŸºæœ¬æ“ä½œç³»ç»Ÿ">#</a> åŸºæœ¬æ“ä½œç³»ç»Ÿ</h2><div class="note warning"><p>ç”±äºä¸åŒçš„å‘è¡Œç‰ˆæœ¬å…¶ä»£ç å®ç°å·®å¼‚å·¨å¤§ï¼Œæ‰€ä»¥å»ºè®®åœ¨å¼€å‘å’Œè°ƒè¯•å†…æ ¸çš„åœºæ™¯ä¸‹ï¼Œåœ¨ç¡®å®šäº† Linux ç‰ˆæœ¬åï¼Œå»ºè®®ä¼˜å…ˆé€‰æ‹©ä½¿ç”¨è¯¥å†…æ ¸ç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼Œä¾‹å¦‚ <code>ubuntu 24.04 LTS</code> é»˜è®¤ä½¿ç”¨ <code>linux 6.8</code> çš„å†…æ ¸ï¼Œé‚£å½“æˆ‘æƒ³è°ƒè¯• <code>6.8</code> çš„å†…æ ¸æ—¶ï¼Œå°±ä¼˜å…ˆé€‰æ‹© <code>ubuntu 24.04</code> ç³»ç»Ÿä½œä¸º qemu çš„åŸºç¡€ç³»ç»Ÿï¼Œè¿™æ ·å¯ä»¥å‡å°‘å¾ˆå¤šä¸å¿…è¦çš„éº»çƒ¦ã€‚</p></div><p>æˆ‘ä»¬ä½¿ç”¨ <code>debootstrap</code> æ¥ä¸º <code>qemu</code> åˆ¶ä½œä¸€ä¸ªæœ€åŸºæœ¬çš„å¯åŠ¨ç›˜ã€‚</p><blockquote><p><code>debootstrap</code> æ˜¯ debian/ubuntu ä¸‹çš„ä¸€ä¸ªå·¥å…·ï¼Œç”¨æ¥æ„å»ºä¸€å¥—åŸºæœ¬çš„ç³»ç»Ÿ (æ ¹æ–‡ä»¶ç³»ç»Ÿ)ã€‚ç”Ÿæˆçš„ç›®å½•ç¬¦åˆ Linux æ–‡ä»¶ç³»ç»Ÿæ ‡å‡† (FHS)ï¼Œå³åŒ…å«äº† /bootã€/etcã€/binã€/usr ç­‰ç­‰ç›®å½•ï¼Œä½†å®ƒæ¯”å‘è¡Œç‰ˆæœ¬çš„ Linux ä½“ç§¯å°å¾ˆå¤šï¼Œå½“ç„¶åŠŸèƒ½ä¹Ÿæ²¡é‚£ä¹ˆå¼ºå¤§ï¼Œå› æ­¤ï¼Œåªèƒ½è¯´æ˜¯ â€œåŸºæœ¬çš„ç³»ç»Ÿâ€ï¼Œä½†ä¹Ÿè¶³å¤Ÿæˆ‘ä»¬ä½¿ç”¨äº†ã€‚ <code>debootstrap</code> çš„ä½¿ç”¨å‘½ä»¤ä¸ºï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> <span class="token function">debootstrap</span> <span class="token parameter variable">--arch</span> <span class="token punctuation">[</span>å¹³å°<span class="token punctuation">]</span> <span class="token punctuation">[</span>å‘è¡Œç‰ˆæœ¬ä»£å·<span class="token punctuation">]</span> <span class="token punctuation">[</span>ç›®å½•<span class="token punctuation">]</span> <span class="token punctuation">[</span>é•œåƒæºåœ°å€<span class="token punctuation">]</span></pre></td></tr></table></figure><p>ä¸åŒ <code>ubuntu</code> å‘è¡Œç‰ˆæœ¬ä»£å·å¯ä»¥åœ¨<span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVWJ1bnR1X3ZlcnNpb25faGlzdG9yeSNUYWJsZV9vZl92ZXJzaW9ucw==">è¿™é‡Œ</span>æŸ¥åˆ°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ <code>lsb_release -a</code> æŸ¥çœ‹è‡ªå·±æœ¬æœºçš„ç³»ç»Ÿä»£ç ï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>â¯ lsb_release <span class="token parameter variable">-a</span></pre></td></tr><tr><td data-num="2"></td><td><pre>No LSB modules are available.</pre></td></tr><tr><td data-num="3"></td><td><pre>Distributor ID:	Ubuntu</pre></td></tr><tr><td data-num="4"></td><td><pre>Description:	Ubuntu <span class="token number">24.04</span>.1 LTS</pre></td></tr><tr><td data-num="5"></td><td><pre>Release:	<span class="token number">24.04</span></pre></td></tr><tr><td data-num="6"></td><td><pre>Codename:	noble</pre></td></tr></table></figure></blockquote><p>é¦–å…ˆå®‰è£…ä¸‹ <code>debootstrap</code> ï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> <span class="token function">apt</span> update</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">debootstrap</span></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘é€‰æ‹© <code>ubuntu 24.04</code> ç‰ˆæœ¬ä½œä¸ºåŸºç¡€ç³»ç»Ÿï¼Œä»£ç  <code>Noble Numbat</code> ï¼ˆå–ç¬¬ä¸€ä¸ªå•è¯ï¼‰ï¼Œå›½å†…ç”¨æˆ·å¯ä»¥ä½¿ç”¨æ¸…åæºåŠ é€Ÿå®‰è£…ï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> <span class="token function">debootstrap</span> <span class="token parameter variable">--arch</span><span class="token operator">=</span>amd64 noble rootfs http://mirrors.ustc.edu.cn/ubuntu/</pre></td></tr></table></figure><p>å®Œæˆåä½¿ç”¨</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> <span class="token function">chroot</span> rootfs</pre></td></tr></table></figure><p>è¿›å…¥ <code>rootfs</code> ç³»ç»Ÿä¸­ï¼Œä»¥ä¸‹æ“ä½œç›´åˆ° <code>exit</code> å‰ï¼Œéƒ½æ˜¯åœ¨è¯¥æ“ä½œç³»ç»Ÿä¸­è¿›è¡Œçš„ã€‚</p><h2 id="åŸºæœ¬å·¥å…·åŠé…ç½®"><a class="anchor" href="#åŸºæœ¬å·¥å…·åŠé…ç½®">#</a> åŸºæœ¬å·¥å…·åŠé…ç½®</h2><p>å®‰è£… busybox</p><blockquote><p>busybox æ˜¯ä¸€ä¸ªé›†æˆäº†ä¸€ç™¾å¤šä¸ªæœ€å¸¸ç”¨ Linux å‘½ä»¤å’Œå·¥å…·ï¼ˆå¦‚ catã€echoã€grepã€mountã€telnet ç­‰ï¼‰çš„ç²¾ç®€å·¥å…·ç®±ï¼Œå®ƒåªéœ€è¦å‡  MB çš„å¤§å°ï¼Œå¾ˆæ–¹ä¾¿è¿›è¡Œå„ç§å¿«é€ŸéªŒè¯ï¼Œè¢«èª‰ä¸º â€œLinux ç³»ç»Ÿçš„ç‘å£«å†›åˆ€â€ã€‚</p></blockquote><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">apt</span> update</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> busybox init</pre></td></tr></table></figure><p>ç„¶åç¼–è¾‘ <code>/init</code> ï¼ˆå¦‚æœæ²¡æœ‰åˆ™æ‰‹åŠ¨åˆ›å»ºï¼‰</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token shebang important">#!/bin/sh</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">mount</span> <span class="token parameter variable">-t</span> proc none /proc</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">mount</span> <span class="token parameter variable">-t</span> sysfs none /sys</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">mount</span> <span class="token parameter variable">-t</span> devtmpfs none /dev</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token builtin class-name">exec</span> /bin/sh</pre></td></tr></table></figure><p>ç„¶åèµ‹äºˆå¯æ‰§è¡Œæƒé™ï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">chmod</span> +x /init</pre></td></tr></table></figure><p>è®¾ç½® <code>root</code> ç”¨æˆ·å¯†ç ï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>root@kernel-fuzz:/<span class="token comment"># passwd</span></pre></td></tr><tr><td data-num="2"></td><td><pre>New password:</pre></td></tr><tr><td data-num="3"></td><td><pre>Retype new password:</pre></td></tr><tr><td data-num="4"></td><td><pre>passwd: password updated successfully</pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥ä½¿ç”¨ <code>exit</code> é€€å‡ºå½“å‰ç³»ç»Ÿäº†ã€‚</p><h2 id="åˆ¶ä½œqemué•œåƒ"><a class="anchor" href="#åˆ¶ä½œqemué•œåƒ">#</a> åˆ¶ä½œ qemu é•œåƒ</h2><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># æ‰“åŒ… rootfs</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">sudo</span> <span class="token function">tar</span> <span class="token parameter variable">-czvf</span> rootfs.tar.gz <span class="token parameter variable">-C</span> rootfs <span class="token builtin class-name">.</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># åˆ›å»ºç¡¬ç›˜</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span>rootfs.img <span class="token assign-left variable">bs</span><span class="token operator">=</span>1M <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">512</span></pre></td></tr><tr><td data-num="6"></td><td><pre>mkfs.ext4 rootfs.img</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token function">mkdir</span> mnt</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token function">sudo</span> <span class="token function">mount</span> rootfs.img mnt</pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment"># å¤åˆ¶</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token function">sudo</span> <span class="token function">tar</span> <span class="token parameter variable">-xzf</span> rootfs.tar.gz <span class="token parameter variable">-C</span> mnt</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token function">sudo</span> <span class="token function">umount</span> mnt</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment"># è½¬æ¢æˆ qcow2 é•œåƒ</span></pre></td></tr><tr><td data-num="15"></td><td><pre>qemu-img convert <span class="token parameter variable">-f</span> raw <span class="token parameter variable">-O</span> qcow2 rootfs.img rootfs.qcow2</pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œå‡†å¤‡å·¥ä½œéƒ½å·²ç»å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è°ƒè¯•å†…æ ¸äº†ã€‚</p><h1 id="è°ƒè¯•å†…æ ¸"><a class="anchor" href="#è°ƒè¯•å†…æ ¸">#</a> è°ƒè¯•å†…æ ¸</h1><h2 id="å¯åŠ¨-qemu-å¹¶å¯ç”¨-gdb-è¿œç¨‹è°ƒè¯•"><a class="anchor" href="#å¯åŠ¨-qemu-å¹¶å¯ç”¨-gdb-è¿œç¨‹è°ƒè¯•">#</a> å¯åŠ¨ QEMU å¹¶å¯ç”¨ GDB è¿œç¨‹è°ƒè¯•</h2><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨ <code>qemu</code> ï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> qemu-system-x86_64 <span class="token parameter variable">-m</span> 2G <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="2"></td><td><pre>	 	        <span class="token parameter variable">-smp</span> <span class="token number">2</span> <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="3"></td><td><pre> 		        <span class="token parameter variable">-kernel</span> /path/to/linux-6.8/arch/x86/boot/bzImage <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="4"></td><td><pre>		        <span class="token parameter variable">-drive</span> <span class="token assign-left variable">file</span><span class="token operator">=</span>/path/to/rootfs.qcow2,format<span class="token operator">=</span>qcow2  <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="5"></td><td><pre>		        <span class="token parameter variable">-append</span> <span class="token string">"console=ttyS0 nokaslr root=/dev/sda rw"</span>  <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="6"></td><td><pre> 		        <span class="token parameter variable">-nographic</span> <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="7"></td><td><pre>		        -enable-kvm <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="8"></td><td><pre>		        <span class="token parameter variable">-s</span> <span class="token parameter variable">-S</span></pre></td></tr></table></figure><ul><li><code>-s</code> ï¼šç›¸å½“äº <code>-gdb tcp::1234</code> ï¼Œåœ¨ç«¯å£ <code>1234</code> ä¸Šå¼€å¯ GDB æœåŠ¡å™¨</li><li><code>-S</code> ï¼šå¯åŠ¨åæš‚åœ CPUï¼Œç­‰å¾… GDB è¿æ¥</li></ul><p>é€šè¿‡ä»¥ä¸Šå‘½ä»¤å¯åŠ¨ <code>qemu</code> åä¼šå¡ä½ï¼Œè¿™æ˜¯å› ä¸º <code>-S</code> å‚æ•°ä¼šæš‚åœ <code>kernel</code> çš„æ‰§è¡Œï¼Œç­‰å¾… <code>GDB</code> çš„è¿æ¥ã€‚</p><h2 id="è‡ªåŠ¨åŠ è½½è°ƒè¯•è„šæœ¬"><a class="anchor" href="#è‡ªåŠ¨åŠ è½½è°ƒè¯•è„šæœ¬">#</a> è‡ªåŠ¨åŠ è½½è°ƒè¯•è„šæœ¬</h2><p>ç”±äºæŸäº›å‘è¡Œç‰ˆå¯èƒ½ä¼šå°† gdb è„šæœ¬çš„è‡ªåŠ¨åŠ è½½é™åˆ¶åœ¨å·²çŸ¥çš„å®‰å…¨ç›®å½•ä¸­ã€‚ <span class="exturl" data-url="aHR0cDovL3huLS1nZGJ2bWxpbnV4LWdkYi1pbzl3NTlleTEwY2dmMWJvOXM0ajBpdzc2Y3luYS5weQ==">å¦‚æœ gdb è¾“å‡ºæ‹’ç»åŠ è½½ vmlinux-gdb.py</span>ï¼ˆç›¸å…³å‘½ä»¤æ‰¾ä¸åˆ°ï¼‰ï¼Œè¯·å°†:</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>add-auto-load-safe-path /path/to/linux-src</pre></td></tr></table></figure><p>æ·»åŠ åˆ° <code>~/.gdbinit</code> ï¼Œè¿™ä¸ª <code>py</code> è„šæœ¬å°±æ˜¯å®ç°äº†ä¸€äº›å†…æ ¸è°ƒè¯•å‘½ä»¤ï¼Œä»–ä»¬éƒ½ä»¥ <code>lx-</code> å¼€å¤´ï¼Œä¸‹é¢ä¼šå±•ç¤ºã€‚</p><h2 id="è¿æ¥-gdb-åˆ°-qemu"><a class="anchor" href="#è¿æ¥-gdb-åˆ°-qemu">#</a> è¿æ¥ GDB åˆ° QEMU</h2><p>åœ¨å®¿ä¸»æœºï¼ˆhostï¼‰ä¸Šï¼Œæ‰“å¼€ <code>gdb</code> å¹¶åŠ è½½è°ƒè¯•ç¬¦å·ï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>gdb vmlinux</pre></td></tr></table></figure><p>ç„¶ååœ¨ GDB ä¸­è¿æ¥åˆ° QEMUï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>target remote :1234</pre></td></tr></table></figure><p>æ­¤æ—¶ GDB ä¼šè¿æ¥åˆ° QEMUï¼ŒCPU ä»ç„¶æš‚åœã€‚è¿™æ—¶å°±å¯ä»¥ä»»æ„åœ¨å†…æ ¸ä¸­æ‰“æ–­ç‚¹è¿›è¡Œè°ƒè¯•äº†ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b start_kernel</pre></td></tr><tr><td data-num="2"></td><td><pre>Breakpoint <span class="token number">1</span> at 0xffffffff83220950: <span class="token function">file</span> init/main.c, line <span class="token number">875</span>.</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c</pre></td></tr><tr><td data-num="4"></td><td><pre>Continuing.</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>Thread <span class="token number">1</span> hit Breakpoint <span class="token number">1</span>, start_kernel <span class="token punctuation">(</span><span class="token punctuation">)</span> at init/main.c:875</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token number">875</span>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span></pre></td></tr></table></figure><details class="warning"><summary>ä¸‹æ–­ç‚¹åæ‰§è¡ŒæŠ¥é”™ï¼šCannot access memory at address 0xffffxxxxxx</summary><div><p>è¿™æ˜¯å› ä¸ºè¾ƒæ–°ç‰ˆæœ¬çš„ linux å†…æ ¸å®ç°äº†ä¸€ä¸ªå†…æ ¸ä»£ç æ®µçš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Œè¯¥æœºåˆ¶é€šè¿‡ <code>CONFIG_STRICT_KERNEL_RWX</code> å’Œ <code>CONFIG_STRICT_MODULE_RWX</code> æ¥é…ç½®ï¼Œä¸€èˆ¬æ˜¯é»˜è®¤å¼€å¯çš„ã€‚å½“è¿™ä¸¤ä¸ªé€‰é¡¹å¼€å¯æ—¶ï¼Œ <code>kgdb</code> æ·»åŠ æ–­ç‚¹æ—¶ï¼Œé»˜è®¤æ˜¯é€šè¿‡å°†æŒ‡å®šå†…æ ¸ä»£ç æ”¹å†™ä¸ºæ–­ç‚¹æŒ‡ä»¤ï¼Œä»è€Œåœ¨æ‰§è¡Œåˆ°æŒ‡å®šä½ç½®æ—¶è§¦å‘è½¯ä»¶æ–­ç‚¹çš„ï¼Œè€Œè¯¥é€‰é¡¹çš„å­˜åœ¨ä¼šå¯¼è‡´æ–­ç‚¹æŒ‡ä»¤æ— æ³•å†™å…¥ï¼Œæ‰€ä»¥æ‰ä¼šå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c</pre></td></tr><tr><td data-num="2"></td><td><pre>Continuing.</pre></td></tr><tr><td data-num="3"></td><td><pre>Warning:</pre></td></tr><tr><td data-num="4"></td><td><pre>Cannot insert breakpoint <span class="token number">1</span>.</pre></td></tr><tr><td data-num="5"></td><td><pre>Cannot access memory at address 0xffffffff83220950</pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•æœ‰ä¸¤ç§ï¼š</p><ol><li>åœ¨ <code>gdb</code> ä¸­ä½¿ç”¨ <code>hb</code> æ›¿ä»£ <code>b</code> æ¥ä¸‹ç¡¬ä»¶æ–­ç‚¹</li><li>åœ¨ <code>.config</code> ä¸­å…³é—­ <code>CONFIG_STRICT_KERNEL_RWX</code> å’Œ <code>CONFIG_STRICT_MODULE_RWX</code> å¹¶é‡æ–°ç¼–è¯‘å†…æ ¸ã€‚ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å¤§å¤šæ•°æ¶æ„ä¸‹ï¼Œè¯¥é€‰é¡¹å·²ç»ä¸æ˜¯ä¸€ä¸ªå¯é€‰é¡¹ï¼Œè€Œæ˜¯ä¸€ä¸ªé»˜è®¤å¼€å¯çš„ç‰¹æ€§ï¼Œæ‰€ä»¥å¯èƒ½æ— æ³•å…³é—­ï¼Œå‚è€ƒï¼š<span class="exturl" data-url="aHR0cHM6Ly9rZ2RiLWJ1Z3JlcG9ydC5uYXJraXZlLmNvbS9zSzc0VU1DMy9wYXRjaC1kb2N1bWVudGF0aW9uLWRvY2Jvb2sta2dkYi11cGRhdGUtY29uZmlnLXN0cmljdC1rZXJuZWwtcnd4LWluZm8lRUYlQkMlODk=">https://kgdb-bugreport.narkive.com/sK74UMC3/patch-documentation-docbook-kgdb-update-config-strict-kernel-rwx-infoï¼‰</span></li></ol><p>ä»¥ä¸Šä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥è§£å†³è¯¥é—®é¢˜ã€‚</p></div></details><p>Linux å†…æ ¸é»˜è®¤å¯¼å‡ºäº†ä¸€äº›å·¥å…·ç”¨äºè°ƒè¯•å†…æ ¸ï¼Œå¯ä»¥ä½¿ç”¨ <code>apropos lx</code> æŸ¥çœ‹ä»–ä»¬ï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token function">apropos</span> lx</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">function</span> lx_clk_core_lookup -- Find struct clk_core by name</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">function</span> lx_current -- Return current task.</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">function</span> lx_dentry_name -- Return string of the full path of a dentry.</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">function</span> lx_device_find_by_bus_name -- Find struct device by bus and name <span class="token punctuation">(</span>both strings<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">function</span> lx_device_find_by_class_name -- Find struct device by class and name <span class="token punctuation">(</span>both strings<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">function</span> lx_i_dentry -- Return dentry pointer <span class="token keyword">for</span> inode.</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">function</span> lx_module -- Find module by name and <span class="token builtin class-name">return</span> the module variable.</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">function</span> lx_per_cpu -- Return per-cpu variable.</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">function</span> lx_radix_tree_lookup --  Lookup and <span class="token builtin class-name">return</span> a <span class="token function">node</span> from a RadixTree.</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">function</span> lx_rb_first -- Lookup and <span class="token builtin class-name">return</span> a <span class="token function">node</span> from an RBTree</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">function</span> lx_rb_last -- Lookup and <span class="token builtin class-name">return</span> a <span class="token function">node</span> from an RBTree.</pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">function</span> lx_rb_next -- Lookup and <span class="token builtin class-name">return</span> a <span class="token function">node</span> from an RBTree.</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">function</span> lx_rb_prev -- Lookup and <span class="token builtin class-name">return</span> a <span class="token function">node</span> from an RBTree.</pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">function</span> lx_task_by_pid -- Find Linux task by PID and <span class="token builtin class-name">return</span> the task_struct variable.</pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">function</span> lx_thread_info -- Calculate Linux thread_info from task variable.</pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">function</span> lx_thread_info_by_pid -- Calculate Linux thread_info from task variable found by pid</pre></td></tr><tr><td data-num="18"></td><td><pre>lx-clk-summary -- Print clk tree summary</pre></td></tr><tr><td data-num="19"></td><td><pre>lx-cmdline -- Report the Linux Commandline used <span class="token keyword">in</span> the current kernel.</pre></td></tr><tr><td data-num="20"></td><td><pre>lx-configdump -- Output kernel config to the filename specified as the <span class="token builtin class-name">command</span></pre></td></tr><tr><td data-num="21"></td><td><pre>lx-cpus -- List CPU status arrays</pre></td></tr><tr><td data-num="22"></td><td><pre>lx-device-list-bus -- Print devices on a bus <span class="token punctuation">(</span>or all buses <span class="token keyword">if</span> not specified<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>lx-device-list-class -- Print devices <span class="token keyword">in</span> a class <span class="token punctuation">(</span>or all classes <span class="token keyword">if</span> not specified<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>lx-device-list-tree -- Print a device and its children recursively</pre></td></tr><tr><td data-num="25"></td><td><pre>lx-dmesg -- Print Linux kernel log buffer.</pre></td></tr><tr><td data-num="26"></td><td><pre>lx-dump-page-owner -- Dump page owner</pre></td></tr><tr><td data-num="27"></td><td><pre>lx-fdtdump -- Output Flattened Device Tree header and dump FDT blob to the filename</pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token parameter variable">--Type</span> <span class="token operator">&lt;</span>RET<span class="token operator">></span> <span class="token keyword">for</span> more, q to quit, c to <span class="token builtin class-name">continue</span> without paging--</pre></td></tr><tr><td data-num="29"></td><td><pre>lx-genpd-summary -- Print genpd summary</pre></td></tr><tr><td data-num="30"></td><td><pre>lx-getmod-by-textaddr -- Look up loaded kernel module by text address.</pre></td></tr><tr><td data-num="31"></td><td><pre>lx-interruptlist -- Print /proc/interrupts</pre></td></tr><tr><td data-num="32"></td><td><pre>lx-iomem -- Identify the IO memory resource locations defined by the kernel</pre></td></tr><tr><td data-num="33"></td><td><pre>lx-ioports -- Identify the IO port resource locations defined by the kernel</pre></td></tr><tr><td data-num="34"></td><td><pre>lx-list-check -- Verify a list consistency</pre></td></tr><tr><td data-num="35"></td><td><pre>lx-lsmod -- List currently loaded modules.</pre></td></tr><tr><td data-num="36"></td><td><pre>lx-mounts -- Report the VFS mounts of the current process namespace.</pre></td></tr><tr><td data-num="37"></td><td><pre>lx-page_address -- struct page to linear mapping address</pre></td></tr><tr><td data-num="38"></td><td><pre>lx-page_to_pfn -- struct page to PFN</pre></td></tr><tr><td data-num="39"></td><td><pre>lx-page_to_phys -- struct page to physical address</pre></td></tr><tr><td data-num="40"></td><td><pre>lx-pfn_to_kaddr -- PFN to kernel address</pre></td></tr><tr><td data-num="41"></td><td><pre>lx-pfn_to_page -- PFN to struct page</pre></td></tr><tr><td data-num="42"></td><td><pre>lx-ps -- Dump Linux tasks.</pre></td></tr><tr><td data-num="43"></td><td><pre>lx-slabinfo -- Show slabinfo</pre></td></tr><tr><td data-num="44"></td><td><pre>lx-slabtrace -- Show specific cache slabtrace</pre></td></tr><tr><td data-num="45"></td><td><pre>lx-sym_to_pfn -- symbol address to PFN</pre></td></tr><tr><td data-num="46"></td><td><pre>lx-symbols -- <span class="token punctuation">(</span>Re-<span class="token punctuation">)</span>load symbols of Linux kernel and currently loaded modules.</pre></td></tr><tr><td data-num="47"></td><td><pre>lx-timerlist -- Print /proc/timer_list</pre></td></tr><tr><td data-num="48"></td><td><pre>lx-version -- Report the Linux Version of the current kernel.</pre></td></tr><tr><td data-num="49"></td><td><pre>lx-virt_to_page -- virtual address to struct page</pre></td></tr><tr><td data-num="50"></td><td><pre>lx-virt_to_phys -- virtual address to physical address</pre></td></tr><tr><td data-num="51"></td><td><pre>lx-vmallocinfo -- Show vmallocinfo</pre></td></tr></table></figure><h1 id="è°ƒè¯•å†…æ ¸æ¨¡å—"><a class="anchor" href="#è°ƒè¯•å†…æ ¸æ¨¡å—">#</a> è°ƒè¯•å†…æ ¸æ¨¡å—</h1><h2 id="ç”Ÿæˆç¬¦å·ä¿¡æ¯"><a class="anchor" href="#ç”Ÿæˆç¬¦å·ä¿¡æ¯">#</a> ç”Ÿæˆç¬¦å·ä¿¡æ¯</h2><p>è°ƒè¯•å†…æ ¸æ¨¡å—æ—¶è¿˜éœ€è¦é¢å¤–åœ¨ç¼–è¯‘å†…æ ¸æ¨¡å—æ—¶ç”Ÿæˆè°ƒè¯•ç¬¦å·ï¼Œå³ <code>make</code> æ—¶æ·»åŠ  <code>-g</code> å‚æ•°ï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">make</span> <span class="token assign-left variable">CFLAGS</span><span class="token operator">=</span><span class="token string">"-g"</span></pre></td></tr></table></figure><p>æˆ–è€…åœ¨ <code>Makefile</code> ä¸­æ·»åŠ ï¼š</p><figure class="highlight makefile"><figcaption data-lang="makefile"></figcaption><table><tr><td data-num="1"></td><td><pre>EXTRA_CFLAGS<span class="token operator">=</span><span class="token string">"-g -DDEBUG"</span></pre></td></tr></table></figure><p>ä¾‹å¦‚ <code>make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules EXTRA_CFLAGS=&quot;-g -DDEBUG&quot;</code> ã€‚</p><h2 id="åŠ è½½æ¨¡å—"><a class="anchor" href="#åŠ è½½æ¨¡å—">#</a> åŠ è½½æ¨¡å—</h2><p>ç›´æ¥åœ¨ <code>qemu</code> ä¸­ä½¿ç”¨ <code>insmod simplefs.ko</code> åŠ è½½æ¨¡å—ï¼Œç„¶åæ­£å¸¸ä¸‹æ–­ç‚¹è°ƒè¯•å³å¯ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå³ä½¿æ¨¡å—è¿˜æ²¡æœ‰åŠ è½½ï¼Œä¹Ÿå¯ä»¥å…ˆè®¾ç½®æ¨¡å—å†…çš„æ–­ç‚¹ï¼Œæ­¤æ—¶ gdb çš„æç¤ºä¸ºï¼š</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b btrfs_init_sysfs</pre></td></tr><tr><td data-num="2"></td><td><pre>Function <span class="token string">"btrfs_init_sysfs"</span> not defined.</pre></td></tr><tr><td data-num="3"></td><td><pre>Make breakpoint pending on future shared library load? <span class="token punctuation">(</span>y or <span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span> y</pre></td></tr><tr><td data-num="4"></td><td><pre>Breakpoint <span class="token number">1</span> <span class="token punctuation">(</span>btrfs_init_sysfs<span class="token punctuation">)</span> pending.</pre></td></tr></table></figure><h1 id="vscodeè°ƒè¯•å†…æ ¸"><a class="anchor" href="#vscodeè°ƒè¯•å†…æ ¸">#</a> VSCode è°ƒè¯•å†…æ ¸</h1><div class="note info"><p>ç”±äº <code>CONFIG_STRICT_KERNEL_RWX</code> çš„é—®é¢˜åªèƒ½ä½¿ç”¨ç¡¬ä»¶æ–­ç‚¹ï¼ŒVSCode å¯¹äºç¡¬ä»¶æ–­ç‚¹æ”¯æŒä¸å¤ªå¥½ï¼Œç­‰å¯»æ‰¾åˆ°æ›´å¥½çš„æ–¹æ¡ˆä¼šç»§ç»­æ›´æ–°ã€‚</p><p>ğŸ‰ğŸ‰ğŸ‰ UPDATEğŸ‰ğŸ‰ğŸ‰</p><p>æ‰¾åˆ°äº†åœ¨ VScode ä¸­æ‰“ç¡¬ä»¶æ–­ç‚¹çš„æ–¹æ³•ï¼Œè¯·å‚è€ƒç¬¬äºŒæ®µ <code>launch.json</code> ã€‚</p></div><p>å¯¹äºä¸å— <code>CONFIG_STRICT_KERNEL_RWX</code> å½±å“çš„ç‰ˆæœ¬æ¥è¯´ï¼Œåªéœ€è¦æŒ‰å¦‚ä¸‹é…ç½®è®¾ç½® <code>launch.json</code> å³å¯ï¼š</p><figure class="highlight json"><figcaption data-lang="JSON"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.2.0"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token property">"configurations"</span><span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"kernel-debug"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"cppdbg"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token property">"program"</span><span class="token operator">:</span> <span class="token string">"$&#123;workspaceFolder&#125;/vmlinux"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token property">"stopAtEntry"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token property">"cwd"</span><span class="token operator">:</span> <span class="token string">"$&#123;workspaceFolder&#125;"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token property">"environment"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token property">"externalConsole"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token property">"logging"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token property">"engineLogging"</span><span class="token operator">:</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token property">"MIMode"</span><span class="token operator">:</span> <span class="token string">"gdb"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token property">"miDebuggerServerAddress"</span><span class="token operator">:</span> <span class="token string">"127.0.0.1:1234"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token property">"setupCommands"</span><span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>          <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"-enable-pretty-printing"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre>          <span class="token property">"ignoreFailures"</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token punctuation">]</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token punctuation">]</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>å¯¹äºå— <code>CONFIG_STRICT_KERNEL_RWX</code> å½±å“çš„ç‰ˆæœ¬ï¼Œä½¿ç”¨å¦‚ä¸‹é…ç½®å³å¯ï¼š</p><figure class="highlight json"><figcaption data-lang="JSON"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token comment">// ä½¿ç”¨ IntelliSense äº†è§£ç›¸å…³å±æ€§ã€‚ </span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token comment">// æ‚¬åœä»¥æŸ¥çœ‹ç°æœ‰å±æ€§çš„æè¿°ã€‚</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token comment">// æ¬²äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®: https://go.microsoft.com/fwlink/?linkid=830387</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.2.0"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token property">"configurations"</span><span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"kernel-debug"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"cppdbg"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token property">"program"</span><span class="token operator">:</span> <span class="token string">"$&#123;workspaceFolder&#125;/vmlinux"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token property">"stopAtEntry"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token property">"cwd"</span><span class="token operator">:</span> <span class="token string">"$&#123;workspaceFolder&#125;"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      <span class="token property">"environment"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token property">"externalConsole"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token property">"logging"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token property">"engineLogging"</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>      <span class="token property">"MIMode"</span><span class="token operator">:</span> <span class="token string">"gdb"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>      <span class="token property">"miDebuggerServerAddress"</span><span class="token operator">:</span> <span class="token string">"127.0.0.1:1234"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token property">"setupCommands"</span><span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>          <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"-enable-pretty-printing"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>          <span class="token property">"ignoreFailures"</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>          <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"set breakpoint pending on"</span><span class="token punctuation">,</span> <span class="token comment">// ä¸èƒ½ç›´æ¥ä¸‹æ–­ç‚¹ï¼Œä¼šç¼ºå°‘ç¬¦å·ä¿¡æ¯</span></pre></td></tr><tr><td data-num="29"></td><td><pre>          <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"set breakpoint pending on"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="30"></td><td><pre>          <span class="token property">"ignoreFailures"</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>          <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"hbreak start_kernel"</span><span class="token punctuation">,</span> <span class="token comment">// ç”¨ hbreak ä¸‹ç¡¬ä»¶æ–­ç‚¹</span></pre></td></tr><tr><td data-num="34"></td><td><pre>          <span class="token property">"ignoreFailures"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="35"></td><td><pre>          <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Set a breakpoint at start_kernel"</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>      <span class="token punctuation">]</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>  <span class="token punctuation">]</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><br><div class="tags"><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" rel="tag"><i class="ic i-tag"></i> æ“ä½œç³»ç»Ÿ</a> <a href="/tags/kernel/" rel="tag"><i class="ic i-tag"></i> kernel</a> <a href="/tags/linux/" rel="tag"><i class="ic i-tag"></i> linux</a> <a href="/tags/%E8%B8%A9%E5%9D%91/" rel="tag"><i class="ic i-tag"></i> è¸©å‘</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-03-06 11:22:46" itemprop="dateModified" datetime="2025-03-06T11:22:46+08:00">2025-03-06</time> </span><span id="misc/trail-and-error/debug-kernel/" class="item leancloud_visitors" data-flag-title="GDB+QEMU è°ƒè¯• Linux å†…æ ¸ä¸å†…æ ¸æ¨¡å—" title="é˜…è¯»æ¬¡æ•°"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">é˜…è¯»æ¬¡æ•°</span> <span class="leancloud-visitors-count"></span> <span class="text">æ¬¡</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> èµèµ</button><p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p><div id="qr"><div><img data-src="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/images/wechatpay.png" alt="Gality å¾®ä¿¡æ”¯ä»˜"><p>å¾®ä¿¡æ”¯ä»˜</p></div><div><img data-src="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/images/alipay.png" alt="Gality æ”¯ä»˜å®"><p>æ”¯ä»˜å®</p></div></div></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>Gality <i class="ic i-at"><em>@</em></i>è—å™¨äºèº«</li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://gality.cn/misc/trail-and-error/debug-kernel/" title="GDB+QEMU è°ƒè¯• Linux å†…æ ¸ä¸å†…æ ¸æ¨¡å—">https://gality.cn/misc/trail-and-error/debug-kernel/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/os/kernel/03-simplefs/" itemprop="url" rel="prev" data-background-image="http:&#x2F;&#x2F;imgcdn.gality.cn&#x2F;blog&#x2F;z2chdp.png" title="ä»é›¶å®ç°FS | å®ç°åˆ—å‡ºç›®å½•åŠŸèƒ½"><span class="type">ä¸Šä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> ä» 0 åˆ° 1</span><h3>ä»é›¶å®ç°FS | å®ç°åˆ—å‡ºç›®å½•åŠŸèƒ½</h3></a></div><div class="item right"><a href="/misc/trail-and-error/flex-bison-print-error/" itemprop="url" rel="next" data-background-image="http:&#x2F;&#x2F;imgcdn.gality.cn&#x2F;blog&#x2F;9pu8bw.jpg" title="C++ Flex&#x2F;Bison æ›´å¥½çš„é”™è¯¯å¤„ç†"><span class="type">ä¸‹ä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> è¸©å‘</span><h3>C++ Flex/Bison æ›´å¥½çš„é”™è¯¯å¤„ç†</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%86%85%E6%A0%B8"><span class="toc-number">1.</span> <span class="toc-text">ç¼–è¯‘å†…æ ¸</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%B6%E4%BD%9Cqemu%E5%90%AF%E5%8A%A8%E7%9B%98"><span class="toc-number">2.</span> <span class="toc-text">åˆ¶ä½œ qemu å¯åŠ¨ç›˜</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.1.</span> <span class="toc-text">åŸºæœ¬æ“ä½œç³»ç»Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%B7%A5%E5%85%B7%E5%8F%8A%E9%85%8D%E7%BD%AE"><span class="toc-number">2.2.</span> <span class="toc-text">åŸºæœ¬å·¥å…·åŠé…ç½®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%B6%E4%BD%9Cqemu%E9%95%9C%E5%83%8F"><span class="toc-number">2.3.</span> <span class="toc-text">åˆ¶ä½œ qemu é•œåƒ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B0%83%E8%AF%95%E5%86%85%E6%A0%B8"><span class="toc-number">3.</span> <span class="toc-text">è°ƒè¯•å†…æ ¸</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8-qemu-%E5%B9%B6%E5%90%AF%E7%94%A8-gdb-%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95"><span class="toc-number">3.1.</span> <span class="toc-text">å¯åŠ¨ QEMU å¹¶å¯ç”¨ GDB è¿œç¨‹è°ƒè¯•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8A%A0%E8%BD%BD%E8%B0%83%E8%AF%95%E8%84%9A%E6%9C%AC"><span class="toc-number">3.2.</span> <span class="toc-text">è‡ªåŠ¨åŠ è½½è°ƒè¯•è„šæœ¬</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5-gdb-%E5%88%B0-qemu"><span class="toc-number">3.3.</span> <span class="toc-text">è¿æ¥ GDB åˆ° QEMU</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B0%83%E8%AF%95%E5%86%85%E6%A0%B8%E6%A8%A1%E5%9D%97"><span class="toc-number">4.</span> <span class="toc-text">è°ƒè¯•å†…æ ¸æ¨¡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E7%AC%A6%E5%8F%B7%E4%BF%A1%E6%81%AF"><span class="toc-number">4.1.</span> <span class="toc-text">ç”Ÿæˆç¬¦å·ä¿¡æ¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97"><span class="toc-number">4.2.</span> <span class="toc-text">åŠ è½½æ¨¡å—</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#vscode%E8%B0%83%E8%AF%95%E5%86%85%E6%A0%B8"><span class="toc-number">5.</span> <span class="toc-text">VSCode è°ƒè¯•å†…æ ¸</span></a></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li><a href="/misc/trail-and-error/blog%E6%90%AD%E5%BB%BA/" rel="bookmark" title="blogæ­å»º&Hello world">blogæ­å»º&Hello world</a></li><li><a href="/misc/trail-and-error/Mac%E4%B8%8B%E4%BD%BF%E7%94%A8GDB/" rel="bookmark" title="Macä¸‹ä½¿ç”¨GDBè¿›è¡Œè°ƒè¯•">Macä¸‹ä½¿ç”¨GDBè¿›è¡Œè°ƒè¯•</a></li><li><a href="/misc/trail-and-error/conda-mamba/" rel="bookmark" title="æœºå™¨å­¦ä¹ -ç¯å¢ƒæ­å»ºè¸©å‘-conda&mamba">æœºå™¨å­¦ä¹ -ç¯å¢ƒæ­å»ºè¸©å‘-conda&mamba</a></li><li><a href="/misc/trail-and-error/Mac-Latex/" rel="bookmark" title="Macä¸‹Latexè®ºæ–‡ä¸€æ¡é¾™">Macä¸‹Latexè®ºæ–‡ä¸€æ¡é¾™</a></li><li><a href="/misc/trail-and-error/RTX4080-tensorflow2/" rel="bookmark" title="åœ¨ RTX 4080 ä¸Šè¿è¡Œ tensorflow 2">åœ¨ RTX 4080 ä¸Šè¿è¡Œ tensorflow 2</a></li><li><a href="/misc/trail-and-error/ubuntu%E6%89%A9%E5%AE%B9/" rel="bookmark" title="Ubuntuè™šæ‹Ÿæœºæ‰©å±•ç£ç›˜ ï½œ å‘½ä»¤è¡Œ ï½œ LVM">Ubuntuè™šæ‹Ÿæœºæ‰©å±•ç£ç›˜ ï½œ å‘½ä»¤è¡Œ ï½œ LVM</a></li><li><a href="/misc/trail-and-error/CLion-CMake/" rel="bookmark" title="CLionæ„å»ºè¿œç¨‹CMakeå¼€å‘ç¯å¢ƒ">CLionæ„å»ºè¿œç¨‹CMakeå¼€å‘ç¯å¢ƒ</a></li><li><a href="/misc/trail-and-error/include-error/" rel="bookmark" title="â€œC/C++æ‰¾ä¸åˆ°å¤´æ–‡ä»¶â€è§£å†³æ–¹æ¡ˆå¤§å…¨">â€œC/C++æ‰¾ä¸åˆ°å¤´æ–‡ä»¶â€è§£å†³æ–¹æ¡ˆå¤§å…¨</a></li><li class="active"><a href="/misc/trail-and-error/debug-kernel/" rel="bookmark" title="GDB+QEMUè°ƒè¯•Linuxå†…æ ¸ä¸å†…æ ¸æ¨¡å—">GDB+QEMUè°ƒè¯•Linuxå†…æ ¸ä¸å†…æ ¸æ¨¡å—</a></li><li><a href="/misc/trail-and-error/flex-bison-print-error/" rel="bookmark" title="C++ Flex/Bison æ›´å¥½çš„é”™è¯¯å¤„ç†">C++ Flex/Bison æ›´å¥½çš„é”™è¯¯å¤„ç†</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Gality" data-src="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/images/avatar.png"><p class="name" itemprop="name">Gality</p><div class="description" itemprop="description">å®‰å…¨æ‚è®° & æ—¥å¸¸éšæ„Ÿ</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">42</span> <span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">20</span> <span class="name">åˆ†ç±»</span></a></div><div class="item tags"><a href="/tags/"><span class="count">59</span> <span class="name">æ ‡ç­¾</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0dhbGl0eTM2OQ==" title="https:&#x2F;&#x2F;github.com&#x2F;Gality369"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span> <a href="https://gality.cn/about/" title="https:&#x2F;&#x2F;gality.cn&#x2F;about&#x2F;" class="item about"><i class="ic i-address-card"></i></a> <span class="exturl item email" data-url="bWFpbHRvOjQzNDQwMDcyNkBxcS5jb20=" title="mailto:434400726@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>å…³äº</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>å°ä¼™ä¼´</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>èµ„æº</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/os/kernel/03-simplefs/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/misc/trail-and-error/flex-bison-print-error/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/os/" title="åˆ†ç±»äº æ“ä½œç³»ç»Ÿ">æ“ä½œç³»ç»Ÿ</a> <i class="ic i-angle-right"></i> <a href="/categories/os/kernel/" title="åˆ†ç±»äº å†…æ ¸">å†…æ ¸</a></div><span><a href="/os/kernel/build-kernel/" title="ä»0å¼€å§‹æ„å»ºLinuxå†…æ ¸">ä»0å¼€å§‹æ„å»ºLinuxå†…æ ¸</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ml/" title="åˆ†ç±»äº æœºå™¨å­¦ä¹ ">æœºå™¨å­¦ä¹ </a> <i class="ic i-angle-right"></i> <a href="/categories/ml/nndl/" title="åˆ†ç±»äº ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ">ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ </a></div><span><a href="/ml/nndl/nndl-1/" title="ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹ç¬”è®°ï¼ˆ1ï¼‰">ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹ç¬”è®°ï¼ˆ1ï¼‰</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ml/" title="åˆ†ç±»äº æœºå™¨å­¦ä¹ ">æœºå™¨å­¦ä¹ </a></div><span><a href="/ml/regularization/" title="ML Regularization">ML Regularization</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/misc/" title="åˆ†ç±»äº æ‚é¡¹">æ‚é¡¹</a> <i class="ic i-angle-right"></i> <a href="/categories/misc/C/" title="åˆ†ç±»äº C++">C++</a></div><span><a href="/misc/c++/tips1/" title="C++ ï½œ åˆ©ç”¨è™šåŸºç±»å®ç°è¿è¡Œæ—¶å¤šæ€">C++ ï½œ åˆ©ç”¨è™šåŸºç±»å®ç°è¿è¡Œæ—¶å¤šæ€</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ponder/" title="åˆ†ç±»äº æ€è€ƒä¸æ²‰æ·€">æ€è€ƒä¸æ²‰æ·€</a></div><span><a href="/ponder/%E9%9D%A2%E8%AF%95%E5%A4%8D%E7%9B%98/" title="ç§‘æŠ€åä¼šé¢è¯•åæ€ä¸æ€»ç»“">ç§‘æŠ€åä¼šé¢è¯•åæ€ä¸æ€»ç»“</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/scientific-research/" title="åˆ†ç±»äº ç§‘ç ”">ç§‘ç ”</a> <i class="ic i-angle-right"></i> <a href="/categories/scientific-research/thesis-reading/" title="åˆ†ç±»äº è®ºæ–‡é˜…è¯»">è®ºæ–‡é˜…è¯»</a></div><span><a href="/scientific-research/thesis-reading/JANUS/" title="è®ºæ–‡é˜…è¯»ï½œ Fuzzing File Systems via Two-Dimensional Input Space Exploration">è®ºæ–‡é˜…è¯»ï½œ Fuzzing File Systems via Two-Dimensional Input Space Exploration</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/misc/" title="åˆ†ç±»äº æ‚é¡¹">æ‚é¡¹</a> <i class="ic i-angle-right"></i> <a href="/categories/misc/trail-and-error/" title="åˆ†ç±»äº è¸©å‘">è¸©å‘</a></div><span><a href="/misc/trail-and-error/include-error/" title="â€œC&#x2F;C++æ‰¾ä¸åˆ°å¤´æ–‡ä»¶â€è§£å†³æ–¹æ¡ˆå¤§å…¨">â€œC/C++æ‰¾ä¸åˆ°å¤´æ–‡ä»¶â€è§£å†³æ–¹æ¡ˆå¤§å…¨</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/misc/" title="åˆ†ç±»äº æ‚é¡¹">æ‚é¡¹</a> <i class="ic i-angle-right"></i> <a href="/categories/misc/trail-and-error/" title="åˆ†ç±»äº è¸©å‘">è¸©å‘</a></div><span><a href="/misc/trail-and-error/Mac%E4%B8%8B%E4%BD%BF%E7%94%A8GDB/" title="Macä¸‹ä½¿ç”¨GDBè¿›è¡Œè°ƒè¯•">Macä¸‹ä½¿ç”¨GDBè¿›è¡Œè°ƒè¯•</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/misc/" title="åˆ†ç±»äº æ‚é¡¹">æ‚é¡¹</a> <i class="ic i-angle-right"></i> <a href="/categories/misc/trail-and-error/" title="åˆ†ç±»äº è¸©å‘">è¸©å‘</a></div><span><a href="/misc/trail-and-error/RTX4080-tensorflow2/" title="åœ¨ RTX 4080 ä¸Šè¿è¡Œ tensorflow 2">åœ¨ RTX 4080 ä¸Šè¿è¡Œ tensorflow 2</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/llvm/" title="åˆ†ç±»äº LLVM">LLVM</a></div><span><a href="/llvm/llvm-tutorial/" title="LLVM ç®€æ˜æ•™ç¨‹">LLVM ç®€æ˜æ•™ç¨‹</a></span></li></ul></div><div><h2>æœ€æ–°è¯„è®º</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2023 â€“ <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Gality @ Samadhi</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="ç«™ç‚¹æ€»å­—æ•°">338k å­—</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">10:14</span></div><div class="powered-by">åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"misc/trail-and-error/debug-kernel/",favicon:{show:"ï¼ˆâ—Â´3ï½€â—ï¼‰å“å‘€å‘€ï½",hide:"(Â´Ğ”ï½€)å“æ­»ä½ "},search:{placeholder:"æ–‡ç« æœç´¢",empty:"å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",stats:"${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"},valine:!0,fancybox:!0,copyright:'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="//cdn.jsdelivr.net/gh/gality369/gality369.github.io@latest/js/app.js?v=0.2.5"></script></body></html>